define("web:static/zf/ai/ai.js",function(a){"use strict";function e(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}a.async(["common:components/jquery/jquery.js","common:components/pcUI/template/template.js","web:components/dropSelect/dropSelect.js","common:components/ui/util/storage.js"],function(a,t,n,i){function l(){function t(a,e){var t=new RegExp("(^|-)"+e+"([^-]*)(-|$)"),n=a.match(t);return null!=n?n[2]:null}function n(e,t){return a.map(e,function(a,e){return{key:parseInt(e,10)+t,value:a.name||a,params:a.value||a.id||parseInt(e,10)+t}})}function i(a,e,t){var n=o&&o[e];return n?a.filter(function(a){return t?n.indexOf(a.params)>=0:a.params==n}).map(function(a){return a.key}):[]}if(d){var l=decodeURIComponent(localStorage.getItem("searchquery"));o=a.extend(o,{pe:t(l,"pe"),ar:t(l,"ar"),rm:t(l,"rm")})}var p={defaultValue:[],mainWidth:120,rangeFlag:!1,type:"single",showSelectedVal:!0},g={};a.each(intelligenceFilter.roomNum.list,function(a,e){a&&(g[a]=e)});{var u={rentSelectData:n(intelligenceFilter.priceRange.list,1),layoutSelectData:n(g,0),regionSelectData:n(intelligenceFilter.regions.list,1)},f=i(u.rentSelectData,"pe"),m=a.extend({},p,{title:"选择租房价格区间",data:u.rentSelectData,defaultValue:f,defaultRange:f&&f.length>0?[]:o&&o.pe&&o.pe.split("_")||[],rangeFlag:!0,toggleMode:"click",selectedClassName:"selected",needDefaultOption:!1,rangeConfig:{unit:"元",fromPlaceholder:"最低租金",toPlaceholder:"最高租金"},selectHandler:function(a){var t=a&&a[0]||"",n=a&&a.length&&"1"!==a[0]?u.rentSelectData[t-1].params:"";s(e({},intelligenceFilter.priceRange.alias,n))},confirmHandler:function(){var a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=a.from,n=void 0===t?"":t,i=a.to,l=void 0===i?"":i,r=n||l?n+"_"+l:"";s(e({},intelligenceFilter.priceRange.alias,r))}}),h=(a("#ai_rentprice").dropSelect(m),a.extend({},p,{title:"选择心仪户型",defaultValue:i(u.layoutSelectData,"rm",!0),toggleMode:"click",selectedClassName:"selected",data:u.layoutSelectData,type:"multiple",selectHandler:function(a){var t=a&&a.length?""+a.join("_"):"";s(e({},intelligenceFilter.roomNum.alias,t))}})),v=(a("#ai_layout").dropSelect(h),a.extend({},p,{title:"选择租房区域",defaultValue:i(u.regionSelectData,"ar"),toggleMode:"click",selectedClassName:"selected",needDefaultOption:!1,data:u.regionSelectData,type:"single",selectHandler:function(a){var t=a&&a.length&&"1"!==a[0]?""+u.regionSelectData[a[0]-1].params:"";s(e({},intelligenceFilter.regions.alias,t))}}));a("#ai_region").dropSelect(v)}a("#ai_submit").click(function(){a("#ai-show").show(),a("#ai-modify").hide(),r(),c()}),a("#ai-modify-btn").click(function(){a("#ai-show").hide(),a("#ai-modify").show()}),a("#ai-pager").on("click",function(e){var t=a(e.target);if(t.hasClass("page-data")){var n=t.data("page");c(n)}}),a("#modify-again").on("click",function(){a("#ai-show").hide(),a("#ai-modify").show()}),r(),c()}function r(){var e=[];a(".search-field").each(function(t,n){var i=a(n).find(".drop-select-main").html();i&&i.indexOf("选择")<0&&i.indexOf("不限")<0&&e.push(i)}),a("#ai-search-content").html(e.join("；"))}function s(e){o=a.extend(o,e),r(),a("#ai-alert-tip").hide()}function c(e){var n=[];a.each(o,function(a,e){e&&n.push(a+e)}),d&&localStorage.setItem("searchquery",encodeURIComponent(n.join("-")));var i="<li class='house-every-item'>\r\n  <dl class='detail-pic clearfix'>\r\n    <dt class='pic'>\r\n      <a href=\"<%= list.url %>\">\r\n        <img src=\"<%= list.picUrls[0] %>\" title='图片'>\r\n      </a>\r\n      <% if(list.category && list.category == 2){ %>\r\n      <span class='roomcount'>统一装修户型</span>\r\n      <% } %>\r\n    </dt>\r\n    <dd class='detail clearfix'>\r\n      <div class='detail-left'>\r\n        <p class='title'>\r\n          <a href=\"<%= list.url %>\"><%= list.title %></a>\r\n          <% if(list.isGuaranty){ %>\r\n            <span class='tag'>信用免押</span>\r\n          <% } %>\r\n        </p>\r\n        <p class='huxing'>\r\n          <%=  list['rentType'] == 1 ? '整租&nbsp;·&nbsp;' : '合租&nbsp;·&nbsp;' %>\r\n          <%=  list['layout'] ? list['layout'] + '&nbsp;·&nbsp;' : ''%>\r\n          <%=  list['area'] %>\r\n        </p>\r\n        <p class='location'><%=  list['location'] + '&nbsp;&nbsp;' + list['address'] %></p>\r\n        <p class='tags clearfix'>\r\n          <% for(var i=0; i < list.tags.length; i++) { %>\r\n          <span><%= list.tags[i] %></span>\r\n          <% } %>\r\n        </p>\r\n        <% if(list['logoUrl'] || list['brandName']) { %>\r\n        <a class='brand' href=\"<%= list.companyUrl ? list.companyUrl : 'javascript:;' %>\" style=\"color:#309DE5;\" target=\"_blank\">\r\n            <%= list['brandName'] %>\r\n        </a>\r\n        <% } %>\r\n      </div>\r\n      <div class='detail-right'>\r\n        <p class='price'><strong><%= list['price'].replace('元/月', '') %></strong><span>元/月</strong></p>\r\n      </div>\r\n    </dd>\r\n  </dl>\r\n</li >";a.ajax({url:aiUrl+(n&&n.length>0?"/":"")+n.join("-"),type:"get",data:{page:e||1,perPage:20},dataType:"json",success:function(e){if(e&&e.data&&e.data.list&&e.data.total>0){a(".no-result").hide(),a("#ai-list").html("");for(var n=e.data.list,l=[],r=0;r<n.length;r++){var s=n[r];l.push(t.parse(i,{list:s}))}a("#ai-list").html(l.join("")),a("#ai-list").show();var c='<% if (data && data.total && Math.ceil(data.total / data.pageSize) > 1) { %>\r\n    <div class="lp-main-page">\r\n        <% if (data.page > 1) { %>\r\n            <a data-page="<%= data.page-1 %>" class="page-data page-prev">上一页</a>\r\n        <% } %>\r\n        <% for(var i = 1; i <= Math.ceil(data.total / data.pageSize); i++) { %>\r\n            <a data-page="<%= i %>" class="page-data page-num <%= i == data.page ? \'cur\' : \'\' %>"><%= i %></a>\r\n        <% } %>\r\n        <% if (data.page < data.maxPage) { %>\r\n            <a data-page="<%= data.page+1 %>" class="page-data page-next">下一页</a>\r\n        <% } %>\r\n        <span class=\'page-total\'>共<%= Math.ceil(data.total / data.pageSize) %>页</span>\r\n    </div>\r\n<% } %>',o=t.parse(c,{data:e.data});a("#ai-pager").html(o)}else a("#ai-list").hide(""),a("#ai-pager").html(""),a(".no-result").show()},error:function(){}})}var o={},d=i.checkLS();l()})});