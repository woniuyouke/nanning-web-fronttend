define("web:static/zf/detail/detail.js",function(e){"use strict";e.async(["common:components/jquery/jquery.js","common:components/ui/zepto/zepto.js","common:components/pcUI/dialog/dialog.js","common:components/pcUI/tips/tips.js","common:components/third-party/swiper/swiper.js","common:components/third-party/lazyload/lazyload.js","common:components/pcUI/baiduMap/baiduMap.js","common:components/pcUI/template/template.js","common:components/ui/loading/loading.js","common:components/pcUI/tooltip/tooltip.js","common:components/previewImg/previewImg.js"],function(e,n,o,t,a,i,s,c,l,r,d){var p={config:{mapTPL:'<p class="tit"><%= name %></p>\r\n<div class="map-line-content">\r\n    <% if(data.length>0){ %>\r\n    <% for(var i = 0;i < data.length;i++){ %>\r\n    <div class="map-item">\r\n        <div class="icon">\r\n            <span class="icon-bg">\r\n                <%= i+1 %>\r\n                <span class="arrow"></span>\r\n            </span>\r\n        </div>\r\n        <div class="map-item-info">\r\n            <p class="name">\r\n                <span><%= data[i].station %></span>\r\n                <span style="float: right"><%= data[i].distance %>米</span>\r\n            </p>\r\n            <p class="text">\r\n                <%= data[i].line %>\r\n            </p>\r\n        </div>\r\n    </div>\r\n    <% } %>\r\n    <% }else {%>\r\n    <p class="no-data">周边暂无<%= name %>信息</p>\r\n    <% } %>\r\n</div>',houseInfo:{objectId:window.aazPage.houseId,type:window.aazPage.type},checkCollectUrl:aazPage.checkFollow,collectUrl:aazPage.addFollow,cancelCollectUrl:aazPage.deleteFollow,ajaxFlag:!1},tiggerFlag:function(){var e=this;e.config.ajaxFlag=e.config.ajaxFlag?!1:!0},init:function(){var n=this;n.check_collect(),n.bindEvent(),n.loadImg(),n.check_show_more_btn(),n.initSwiper(),n.showHeyanma(),n.loading=new l,e("#map-detailaddress").hover(function(){e("#map-tooltipwrap").toggle()})},check_collect:function(){var n=this;e.ajax({url:n.config.checkCollectUrl,type:"get",dataType:"json",data:n.config.houseInfo,success:function(n){0===n.code?n.data.followed&&(e(".J_follow-btn.follow-btn").html('<em class="iconfont icon-focused_ic"></em>已关注').addClass("added"),e(".J_follow-btn.btn").html('<em class="iconfont icon-focused_ic"></em>').addClass("added")):console.log(n.msg)},error:function(){t.error("网路错误")}})},collect:function(){var n=this;return n.config.ajaxFlag?!1:(n.tiggerFlag(),void e.ajax({url:n.config.collectUrl,type:"get",dataType:"json",data:n.config.houseInfo,success:function(o){0===o.code?o.data.id>0?(e(".J_follow-btn.follow-btn").html('<em class="iconfont icon-focused_ic"></em>已关注').addClass("added"),e(".J_follow-btn.btn").html('<em class="iconfont icon-focused_ic"></em>').addClass("added")):console.log("关注失败"):"NO_LOGIN"==o.code&&e(".login-dialog-wrapper").dialog("instance").open(),n.tiggerFlag()},error:function(){t.error("网路错误"),n.tiggerFlag()}}))},cancelCollect:function(){var n=this;return n.config.ajaxFlag?!1:(n.tiggerFlag(),void e.ajax({url:n.config.cancelCollectUrl,type:"get",dataType:"json",data:n.config.houseInfo,success:function(o){0===o.code?o.data.id>0?(e(".J_follow-btn.follow-btn").html('<em class="iconfont icon-focus_ic"></em>关注房源').removeClass("added"),e(".J_follow-btn.btn").html('<em class="iconfont icon-focus_ic"></em>').removeClass("added")):t.show("取消关注失败"):t.error(o.msg),n.tiggerFlag()},error:function(){t.error("网路错误"),n.tiggerFlag()}}))},showHeyanma:function(){e("#heyanmatext").on("mouseover",function(){e("#heyanmaimg").show()}).on("mouseout",function(){e("#heyanmaimg").hide()}),e("#heyanmaimg").on("mouseover",function(){e("#heyanmaimg").show()}).on("mouseout",function(){e("#heyanmaimg").hide()})},initSwiper:function(){function n(){e(".album-thumbs .active-nav").removeClass("active-nav");e(".album-thumbs .swiper-slide").eq(o.activeIndex).addClass("active-nav")}e(".swiper-slide > img").each(function(){var n=e(this);n.height()>n.width()?(n.height("auto !important"),n.width("100%")):n.width("auto !important")}),e(".pics-wrap img").each(function(){var n=e(this);n.height()>n.width()?(n.css({width:"auto"}),n.height("auto")):(n.css({height:"100%"}),n.width("auto"))}),e(".preImg").on("click",function(){d.open(e(".preImg"),e(this))});var o=new a(".album-wrap",{nextButton:".swiper-next",prevButton:".swiper-prev",spaceBetween:10,onSlideChangeStart:function(){n()}}),t=new a(".album-thumbs",{slidesPerView:4,slidesPerGroup:4,spaceBetween:2,onInit:function(){e(".album-thumbs .swiper-slide").eq(0).addClass("active-nav")}});e(".album-thumbs .swiper-slide").click(function(){o.slideTo(e(this).index(".album-thumbs .swiper-slide"))}),e(".thumbs-wrap .album-prev").on("click",function(e){return e.preventDefault(),0==t.activeIndex?void t.slideTo(t.slides.length-1,1e3):void t.slidePrev()}),e(".thumbs-wrap .album-next").on("click",function(e){return e.preventDefault(),t.activeIndex==t.slides.length-1?void t.slideTo(0,1e3):void t.slideNext()})},loadImg:function(){n("img.lazy").lazyload()},bindEvent:function(){var n=this;e(".J_follow-btn").click(function(){e(this).hasClass("added")?n.cancelCollect():n.collect()}),e("#J_rooms-wrapper").dialog({customWraper:!0}),e(document).on("click","#J_rooms-wrapper .J_close",function(){e("#J_rooms-wrapper").dialog("instance").close()}),e("#J_more-rooms-btn").click(function(){e("#J_rooms-wrapper").dialog("instance").open()}),e("#J_show-row").on("click",function(){e("#J_pics-wrap").css("maxHeight","inherit"),e(this).css("display","none")});var o=[];e(".nav-module").each(function(){o.push(parseInt(e(this).offset().top-50))}),e("#J_nav-tab .item").click(function(){e("body,html").animate({scrollTop:parseInt(o[e(this).index()]+10)},0)}),window.addEventListener("scroll",function(){var n;return function(){n&&clearTimeout(n),n=setTimeout(function(){var n=e(window).scrollTop();if(n>o[o.length-1])e("#J_nav-tab .house-info").css("display","none"),e("#J_nav-tab .item").eq(o.length-1).addClass("selected").siblings().removeClass("selected");else for(var t=0;t<o.length;t++)if(n<=o[t]){var a=e("#J_nav-tab .item").eq(t-1).text();return"房源图片"==a||"位置周边"==a||"推荐房源"==a?e("#J_nav-tab .house-info").css("display","none"):e("#J_nav-tab .house-info").css("display","block"),e("#J_nav-tab .item").eq(t-1).addClass("selected").siblings().removeClass("selected"),1>t?e("#J_nav-tab").css("display","none"):e("#J_nav-tab").css("display","block"),!1}},10)}}()),e(".thumbs-wrapper").mouseenter(function(){e(".show-btn").css("opacity",0),e(".thumbs-wrapper").css("bottom",0)}).mouseleave(function(){e(".thumbs-wrapper").css("bottom","-112px"),e(".show-btn").css("opacity",1)}),e(".map-wrap .tab").on("click",function(){var o=e(this).data("name");n.baidu=new s({dom:"J_house_map",housePoint:mapValue,pageType:"webDetail",loupanName:aazPage.houseName,dragging:!0,pinchToZoom:!1,scrollWheelZoom:!1}),e(this).addClass("selected").siblings().removeClass("selected"),n.baidu.show_return_place_point(e(this).data("name")).then(function(t){var a=[];a.push(c.parse(n.config.mapTPL,{data:t,name:o})),e("#J_map_items").html(a.join(""));var i=e("#J_map_items .map-item");i.on("mouseenter",function(){n.baidu.hover_point(e(this).index(".map-line-content .map-item")+1,!0)}),i.on("mouseleave",function(){n.baidu.hover_point(e(this).index(".map-line-content .map-item")+1,!1)})})}),e(".map-wrap .tab:eq(0)").trigger("click"),e("#public-type-select").dialog({customWraper:!0}),e("#applyAllow").on("click",function(){e("#public-type-select").dialog("instance").open()}),e("#public-type-select .close-btn").on("click",function(){e("#public-type-select").dialog("instance").close()}),e("#public-type-select .list-item").on("click",function(){e(this).addClass("selected").siblings().removeClass("selected")}),e("#submit-sel").on("click",function(){var n=e("#public-type-select .list-item.selected").data("type");location.href="/pc/user/publicrental/apply?publicType="+n}),e(".J_tel_call").click(function(){n.loading.open(),e.ajax({url:aazPage.fourHundreUrl,type:"get",dataType:"json",success:function(o){if(n.loading.hide(),0===o.code){var t=o.data.phone;e("#J_tel_dialog").dialog("instance").open(),e(".J-tel_phone_number").html(t)}else e("#J_tel_dialog_error").dialog("instance").open()},error:function(){n.loading.hide(),t.error("网路错误")}})}),e("#J_tel_dialog").find(".J_close,.J_close_btn").click(function(){e("#J_tel_dialog").dialog("instance").close()}),e("#J_tel_dialog_error").find(".J_close,.J_close_btn").click(function(){e("#J_tel_dialog_error").dialog("instance").close()})},check_show_more_btn:function(){var n=e("#J_show-row"),o=document.getElementById("J_pics-wrap");o.scrollHeight>o.offsetHeight&&n.css({display:"block"})}};p.init()})});