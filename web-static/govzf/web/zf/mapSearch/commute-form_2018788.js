define("web:static/zf/mapSearch/commute-form.js",function(t){"use strict";t.async(["common:components/jquery/jquery.js","common:components/ui/nstSlider/nouislider.js","common:components/pcUI/tips/tips.js","web:components/utils/store.js"],function(t,e,i,a){function n(){var e=d.trafficType.map(function(t){return'\n            <a href="javascript:void(0);" \n                class="traf-btn '+(1==t.id?"cur":"")+'"\n                data-type-id="'+t.id+'">\n                <span class="iconfont traf-icon">&#x'+t.iconfont+'</span>\n                <span class="traf-text">'+t.title+"</span>\n            </a>\n        "});t("#J_traffic_style").html(e.join(""));var i=d.trafficTime;t("#J_tq_time").append('\n            <div class="nouislider" id="J_tq_nouislider"\n				 data-submit-tqtime="'+i.defaultValue+'"\n				 data-increment="'+i.step+'"\n				 data-range_min="'+i.min+'"\n				 data-range_max="'+i.max+'">\n			</div>\n        ');var a=d.expectPrice.map(function(t){return'<span class="price-item '+(t.key?"":"price-item-selected")+'" data-key="'+t.key+'">'+t.title+"</span>"});t("#J_tq_priceSelect").html(a.join("")),t("#J_tq_price").on("click",".price-item",function(){t(".expectPrice").find(".range-input").val("");var e=t(this);e.parent().find(".price-item-selected").removeClass("price-item-selected"),e.addClass("price-item-selected");var i=e.attr("data-key");console.log("expect price: ",i)});var n=t("#J_tq_priceSelect").find(".price-item");t("#J_tq_price").on("keyup",".range-input",function(){n.removeClass("price-item-selected");var e=t(this);e.val(e.val().replace(/\D/g,""))}),t("#J_aaz_tqzfform_page .choose-des-btn").on("input",function(){t("#J_destination_lng").val(""),t("#J_destination_lat").val(""),t.ajax({url:"//api.map.baidu.com/place/v2/search?ak=dCfxVQH8PlNRzQgP51QLOxCbgyNUbXVz&output=json",type:"get",dataType:"jsonp",data:{query:t.trim(t(this).val()),region:_config.location},success:function(e){if(t(".dest-suglist-box").show(),0==e.status){var i="";if(e.results.length){for(var a=0,n=e.results.length;n>a;a++)e.results[a].location&&(i+='<li class="suggest-item"><a href="javascript:void(0);" class="each-bd-li" data-bd-lng="'+e.results[a].location.lng+'" data-bd-lat="'+e.results[a].location.lat+'">'+e.results[a].name+"</a></li>");t("#J_bd_suglist").html(i).show(),t(".no-result-tosug").hide()}else t("#J_bd_suglist").html("").hide(),t(".no-result-tosug").show()}else t("#J_bd_suglist").hide(),t(".no-result-tosug").show()}})}),t("body").on("click",function(e){var i=e.target&&e.target.className||"";if(-1===["choose-des-btn","suggest-item"].indexOf(i)){t(".dest-suglist-box").hide();var a=t("#J_destination_lng").val();a||t(".choose-des-btn").val("")}}),t("#J_bd_suglist").on("click",".suggest-item",function(){var e=t(this).find(".each-bd-li");t(".choose-des-btn").addClass("changeClass").val(e.html()),t("#J_destination_lng").val(e.data("bd-lng")),t("#J_destination_lat").val(e.data("bd-lat")),t(".dest-suglist-box").hide(),t(".validate-tips").html("")}),t(".traf-btn").on("click",function(){if(!t(this).hasClass("cur")){t(this).addClass("cur").siblings().removeClass("cur");var e=t(this).attr("data-type-id")||1;t("#J_tq_nouislider .noUi-handle-lower .slider-icon").html(o(e))}}),t(".find-house-btn").on("click",function(){var e=t("#J_destination_lng").val(),i=t("#J_destination_lat").val(),a=t(".choose-des-btn").val();if(!(e&&i&&a))return t(".validate-tips").html("请填写公司地址"),!1;var n=t(".traf-btn.cur").attr("data-type-id"),s=t("#J_tq_nouislider").attr("data-submit-tqtime"),c=t(".tqtimetext").text(),o=r(),d={address:{title:a,lng:e,lat:i},trafficType:n,commuteTime:s,expectPrice:o};l(a,e,i,n,s,c,o),console.info(">>>Submit from data: ",d);var m=o?"pe"+o:"",u="/pc/commuting/list/"+m+"?trafficTime="+s+"&trafficType="+n+("&destinationLng="+e+"&destinationLat="+i+"&adress="+a);window.location=u.replace("/?","?")}),s(),c()}function s(){var i=document.getElementById("J_tq_nouislider"),n=a.get("tqzfData")||{};n&&n.tqtime&&t("#J_tq_nouislider").attr("data-submit-tqtime",n.tqtime.tqtimeval),e.create(i,{start:t("#J_tq_nouislider").data("submit-tqtime"),connect:[!0,!1],step:t("#J_tq_nouislider").data("increment"),range:{min:t("#J_tq_nouislider").data("range_min"),max:t("#J_tq_nouislider").data("range_max")},pips:{mode:"steps",stepped:!0,density:15}}),i.noUiSlider.on("update",function(e){var i=parseInt(e[0],10),a="";90>=i&&(a=i+"分钟内"),t(".tqtimetext").html(a),t("#J_tq_nouislider").attr("data-submit-tqtime",i);var n=i/15-1;t(".noUi-value.noUi-value-horizontal").addClass("tqsj-stepcycle");for(var s=t(".noUi-value.tqsj-stepcycle"),r=0;n>r;r++)t(s[r]).addClass("stepped");s.eq(n).removeClass("tqsj-stepcycle stepped");for(var r=n+1;5>=r;r++)s.eq(r).removeClass("stepped")})}function r(){var e=t(".expectPrice"),i=e.find(".min-price").val(),a=e.find(".max-price").val();if(""!==i&&""!==a&&+i>+a){var n=[i,a];i=n[1],a=n[0]}var s=e.find(".price-item-selected").attr("data-key")||"";return i||a?i+"_"+a:s}function l(t,e,n,s,r,l,c){var o={destText:t,destlng:e,destlat:n,trafway:s,tqtime:{tqtimeval:r,tqtimetext:l},expectPrice:c};try{a.set("tqzfData",o)}catch(d){i.show("您已开启隐私/无痕模式，可能导致数据异常。为了正常展示，请切换回正常模式！",4500),Storage.prototype._setItem=Storage.prototype.setItem,Storage.prototype.setItem=function(){}}}function c(){var e=a.get("tqzfData")||null,i=o(e&&e.trafway||1);if(t(t("#J_tq_nouislider .noUi-handle-lower")[0]).append('<span class="iconfont traf-icon slider-icon">'+i+"</span>"),e){t(".choose-des-btn").val(e.destText),t("#J_destination_lng").val(e.destlng),t("#J_destination_lat").val(e.destlat),t(".traf-btn").removeClass("cur"),t(".traf-btn").eq(e.trafway-1).addClass("cur"),e.tqtime&&(t("#J_tq_nouislider").attr("data-submit-tqtime",e.tqtime.tqtimeval),t(".tqtimetext").text(e.tqtime.tqtimetext));var n=e.expectPrice||"";if(n){var s=d.expectPrice.find(function(t){return t.key===n})||{};if(s&&s.key)t("#J_tq_priceSelect").find(".price-item").removeClass("price-item-selected"),t("#J_tq_priceSelect").find('.price-item[data-key="'+n+'"]').addClass("price-item-selected");else{var r=n.split("_"),l=t(".expectPrice");l.find(".min-price").val(r[0]),l.find(".max-price").val(r[1])}}}}function o(t){switch(~~t){case 1:return"&#xe7d9";case 2:return"&#xe7d8";case 3:return"&#xe7da";case 4:return"&#xe7d7";default:return"&#xe7d9"}}console.log("commute-form.js loaded successfully...");var d={trafficType:[{id:1,iconfont:"e7d9",title:"公共交通"},{id:2,iconfont:"e7d8",title:"骑行"},{id:3,iconfont:"e7da",title:"步行"},{id:4,iconfont:"e7d7",title:"驾车"}],trafficTime:{min:15,max:90,unit:"分钟",step:15,defaultValue:15},expectPrice:[{title:"不限",key:""},{title:"1500以下",key:"_1500"},{title:"1500-2000",key:"1500_2000"},{title:"2000-3000",key:"2000_3000"},{title:"3000-4000",key:"3000_4000"},{title:"4000-5000",key:"4000_5000"},{title:"5000以上",key:"5000_"}]};n()})});