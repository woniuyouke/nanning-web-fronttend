define("web:static/member/user/verify/verify.js",function(e){"use strict";e.async(["common:components/jquery/jquery.js","common:components/pcUI/uploader/uploader.js","common:components/pcUI/dialog/dialog.js","common:components/pcUI/suggestion/suggestion.js","common:components/pcUI/cuteTips/cuteTips.js","common:components/ui/loading/loading.js","common:components/pcUI/tooltip/tooltip.js"],function(e,t,a,i,r,o){var n=!1,s={config:{ownerIndex:1,cityData:{},city:"南宁市",postPoint:{}},pics:[],propertyPic:[],propertyIdCardPic:[],proxyPic:[],houseSaleContractProofPic:[],houseDeliveryDescPic:[],index:0,crpInfo:[],isTake:!0,liArr:[],communityId:"",firstOwnerName:"",firstOwnerNum:"",firstOwnerMobile:"",init:function(){var t=this;t.loading=new o,t.hideContent(!0),t.initAjax(),e(".dialog-wrapper").dialog({customWraper:!0}),t.bindEvents(),t.uploaderImg(),t.delImg(),t.selectCreated(),""==window.configUrl.id,e("#shili-btn").click(function(){e("#shili-wrap").toggle()}),e("#shili-btn").hover(function(){e("#shili-wrap").toggle()})},rightProofTypeRely:function(){var t=e(".rightProofType option:checked").attr("rightprooftypeindex");if("1"==t||"4"==t){e(".credentials-wrapper").css("display","block"),e(".houseSaleContractProofPic-wrapper").css("display","none"),e(".houseDeliveryDescPic-wrapper").css("display","none"),e(".shili-content").remove();var a='<div class="shili-content"><p>示例1 邕房权证字第XXXXXXXX号</p><p>示例2 桂(2018)南宁市不动产权第XXXXXXX号</p></div>';e("#shili-wrap").append(a),e(".propertyType").attr("disabled","disabled"),e(".propertyType").get(0).selectedIndex="1"}else if("2"==t){e(".credentials-wrapper").css("display","none"),e(".houseSaleContractProofPic-wrapper").css("display","block"),e(".houseDeliveryDescPic-wrapper").css("display","block"),e(".shili-content").remove();var a='<div class="shili-content"><p>示例1 YS0000001</p><p>示例2 QF2018010100000</p></div>';e("#shili-wrap").append(a),e(".propertyType").attr("disabled","disabled"),e(".propertyType").get(0).selectedIndex="2"}else if("3"==t){e(".credentials-wrapper").css("display","none"),e(".houseSaleContractProofPic-wrapper").css("display","block"),e(".houseDeliveryDescPic-wrapper").css("display","block"),e(".shili-content").remove();var a='<div class="shili-content"><p>示例1 YS0000001</p><p>示例2 QF2018010100000</p></div>';e("#shili-wrap").append(a),e(".propertyType").attr("disabled","disabled"),e(".propertyType").get(0).selectedIndex="2"}},selectCreated:function(){var t=this;e("#addOwner").on("click",function(){var a=t.config.ownerIndex,i='<div class="owner-wrapper"><div class="title">共有权利人'+a+'</div><div class="delete-wrapper clearfix"><i class="iconfont icon-nav_detele color-grey"></i><div class="delete-text">删除</div></div><div class="container"><div class="container-top clearfix"><div style="overflow:hidden;"><div class="container-top-rightProofType clearfix"><label class="common-label"><span class="required">*</span>所有权利证明类型</label><div class="clearfix msgDiv"><select class="select-box rightProofType-crp"><option value="">请选择</option></select></div></div><div class="container-top-propertyrightno clearfix"><label class="common-label"><span class="required">*</span>所有权利证明编号</label><input type="text" placeholder="请输入所有权利证明编号" class="propertyrightno"></div></div><div style="overflow:hidden;"><div class="container-top-left clearfix"><label class="common-label"><span class="required">*</span>共有权利人姓名</label><input type="text" placeholder="请输入共有权利人姓名" class="ownerInputName"></div><div class="container-top-right"><label class="common-label ownerLabel"><span class="required">*</span>共有权利人证件号码</label><input type="text" placeholder="请输入共有权利人证件号码" class="ownerInputNum"></div></div><div style="overflow:hidden;margin-top:20px;"><div class="container-top-left clearfix"><label class="common-label"><span class="required">*</span>共有权利人电话</label><input type="text" placeholder="请输入共有权利人电话" class="ownerInputMobile"></div></div></div><div class="container-bottom clearfix propertyIdCardPic-wrapper"><div class="container-bottom-left container-bottom-left-icard clearfix"><label class="common-label creditor-label special-label"><span class="required">*</span>共有权利人证件照片</label><div class="container-tips">(证件正反面)</div></div><div class="pre pre-selectOwnerImg"><div class="container-bottom-right clearfix owner-upload-wrapper'+a+'"><a href="javascript:;" id="selectOwnerImg'+a+'" data-id='+a+' class="upload uploadImg">点此上传</a><input type="file" class="hidden-field" id="selectOwnerImg1Input'+a+'" multiple="multiple"></div></div><div id="owner-img-uploader'+a+'" class="image-wrapper clearfix"></div></div></div></div>';e("#owner").append(i);var r='<option value="">请选择</option>';for(var o in t.rightProofType)r+='<option rightprooftypeindex="'+o+'">'+t.rightProofType[o]+"</option>",e(".rightProofType-crp").html("").append(r);t.isTake&&t.crpInfo.push({rightProofType:"",propertyRightNo:"",name:"",idcard:"",pics:[]}),t.imgUpload(a),t.imgDelete(a),t.config.ownerIndex++}),e(".contain-main").on("click",".delete-wrapper",function(){var a=e(this).parent().index();e(this).parent().remove();for(var i=0;i<e(".owner-wrapper").length;i++)e(".owner-wrapper .title").eq(i).html("共有权利人"+parseInt(i+1)),e(".owner-wrapper .container-bottom-right>.uploadify").eq(i).attr("id","selectOwnerImg"+parseInt(i+1)),e(".owner-wrapper .image-wrapper").eq(i).attr("id","owner-img-uploader"+parseInt(i+1));t.crpInfo.splice(parseInt(a-1),1),t.config.ownerIndex--})},initAjax:function(){var t=this;e.ajax({url:window.configUrl.dictErpUrl,type:"get",dataType:"json",success:function(a){if(a.success){for(var i in a.data.rightProofType){t.rightProofType=a.data.rightProofType;var r='<option rightprooftypeindex="'+i+'">'+a.data.rightProofType[i]+"</option>";e(".rightProofType").append(r)}e(".rightProofType").get(0).selectedIndex="1";for(var i in a.data.enterpriseArea){t.enterpriseArea=a.data.enterpriseArea;var r='<option enterpriseareaindex="'+i+'">'+a.data.enterpriseArea[i]+"</option>";e(".enterpriseArea").append(r)}for(var i in a.data.propertyType){t.propertyType=a.data.propertyType;var r='<option propertytypeindex="'+i+'">'+a.data.propertyType[i]+"</option>";e(".propertyType").append(r)}e("#J_PropertyType").html(a.data.propertyType[1]),t.rightProofTypeRely();for(var i in a.data.situation){var r='<option situationindex="'+i+'">'+a.data.situation[i]+"</option>";e(".situation").append(r)}for(var i in a.data.toward){var r='<option towardindex="'+i+'">'+a.data.toward[i]+"</option>";e(".toward").append(r)}for(var i in a.data.paymentMethod){var r='<option paymentwayindex="'+i+'">'+a.data.paymentMethod[i]+"</option>";e(".paymentWay").append(r)}for(var i in a.data.rentType){var r='<option renttypeindex="'+i+'">'+a.data.rentType[i]+"</option>";e(".rentType").append(r)}for(var i in a.data.natureLand){var r='<option naturelandindex="'+i+'">'+a.data.natureLand[i]+"</option>";e(".natureLand").append(r)}for(var i in a.data.houseTag){var r='<label class="clearfix"><input type="checkbox" housetagindex="'+i+'"><div class="unit">'+a.data.houseTag[i]+"</div></label>";e(".tags").append(r)}for(var i in a.data.houseCollocation){var r='<label class="clearfix"><input type="checkbox" housecollocationindex="'+i+'"><div class="unit">'+a.data.houseCollocation[i]+"</div></label>";e(".collocation").append(r)}for(var i in a.data.landlordRequest){var r='<label class="clearfix"><input type="checkbox" landlordrequestindex="'+i+'"><div class="unit">'+a.data.landlordRequest[i]+"</div></label>";e(".landlordRequest").append(r)}""!=window.configUrl.id&&t.editForm(window.configUrl.id)}}})},uploaderImg:function(){var t=this;e("#owner").on("click",".uploadImg",function(){var t=e(this).attr("data-id");return e("#selectOwnerImg1Input"+t).trigger("click"),!1}),e("#selectOwnerImg1").on("click",function(){e("#selectOwnerImg1Input").trigger("click")}),e("#selectOwnerImg1Input").on("change",function(a){var i=new FormData,o=a.target.files||a.dataTransfer.files;for(var n in o)i.append("part"+n,o[n]);t.loading.open(),e.ajax({url:"http://"+window.configUrl.postPicsUrl+"/upload/house.html",type:"post",data:i,contentType:!1,processData:!1,cache:!1,success:function(a){if(a.code)return r.warn(a.file),!1;for(var i in a){if(t.propertyIdCardPic[0]){if(2==t.propertyIdCardPic.length)return void r.warn("只能上传两张图片！");if(t.propertyIdCardPic[0].imgKey&&t.propertyIdCardPic[0].imgKey==a[i].sKey)return void r.warn("请不要上传相同的图片！")}var o={imgKey:a[i].sKey,imgExt:a[i].sExt};if(t.propertyIdCardPic.push(o),/^(png|jpe?g)$/.test(a[i].sExt)){e("#selectOwnerImg1Input").val("");var n="http://"+window.configUrl.viewUrl+"/view/house/"+a[i].sKey+"/900x675."+a[i].sExt,s=e('<div class="image-item"><img src="'+n+'"><a class="images-del">x</a><a class="preview-image">预览</a></div>');e(".owner-upload-wrapper").before(s)}}},complete:function(){t.loading.hide()}})}),e("#selectHouseImg").on("click",function(){e("#selectHouseImgInput").trigger("click")}),e("#selectHouseImgInput").on("change",function(a){var i=new FormData,o=a.target.files||a.dataTransfer.files;for(var n in o)i.append("part"+n,o[n]);t.loading.open(),e.ajax({url:"http://"+window.configUrl.postPicsUrl+"/upload/house.html",type:"post",data:i,contentType:!1,processData:!1,cache:!1,success:function(a){if(a.code)return r.warn(a.file),!1;for(var i in a){var o={imgKey:a[i].sKey,imgExt:a[i].sExt};if(t.pics.push(o),/^(png|jpe?g)$/.test(a[i].sExt)){var n="http://"+window.configUrl.viewUrl+"/view/house/"+a[i].sKey+"/900x675."+a[i].sExt,s=e('<div class="image-item"><img src="'+n+'"><a class="images-del">x</a><a class="preview-image">预览</a></div>');e("#House-img-uploader").width("115px").before(s)}}},complete:function(){t.loading.hide()}})}),e("#selectHouseSaleContractProofPic").on("click",function(){e("#selectHouseSaleContractProofPicInput").trigger("click")}),e("#selectHouseSaleContractProofPicInput").on("change",function(a){var i=new FormData,o=a.target.files||a.dataTransfer.files;for(var n in o)i.append("part"+n,o[n]);t.loading.open(),e.ajax({url:"http://"+window.configUrl.postPicsUrl+"/upload/house.html",type:"post",data:i,contentType:!1,processData:!1,cache:!1,success:function(a){if(a.code)return r.warn(a.file),!1;for(var i in a){var o={imgKey:a[i].sKey,imgExt:a[i].sExt};if(t.houseSaleContractProofPic.push(o),/^(png|jpe?g)$/.test(a[i].sExt)){var n="http://"+window.configUrl.viewUrl+"/view/house/"+a[i].sKey+"/900x675."+a[i].sExt,s=e('<div class="image-item"><img src="'+n+'"><a class="images-del">x</a><a class="preview-image">预览</a></div>');e(".houseSaleContractProof-upload-wrapper").before(s)}}},complete:function(){t.loading.hide()}})}),e("#selectHouseDeliveryDescPic").on("click",function(){e("#selectHouseDeliveryDescPicInput").trigger("click")}),e("#selectHouseDeliveryDescPicInput").on("change",function(a){var i=new FormData,o=a.target.files||a.dataTransfer.files;for(var n in o)i.append("part"+n,o[n]);t.loading.open(),e.ajax({url:"http://"+window.configUrl.postPicsUrl+"/upload/house.html",type:"post",data:i,contentType:!1,processData:!1,cache:!1,success:function(a){if(a.code)return r.warn(a.file),!1;for(var i in a){var o={imgKey:a[i].sKey,imgExt:a[i].sExt};if(t.houseDeliveryDescPic.push(o),/^(png|jpe?g)$/.test(a[i].sExt)){var n="http://"+window.configUrl.viewUrl+"/view/house/"+a[i].sKey+"/900x675."+a[i].sExt,s=e('<div class="image-item"><img src="'+n+'"><a class="images-del">x</a><a class="preview-image">预览</a></div>');e(".houseDeliveryDesc-upload-wrapper").before(s)}}},complete:function(){t.loading.hide()}})}),e("#selectCredentialsImg").on("click",function(){e("#selectCredentialsImgInput").trigger("click")}),e("#selectCredentialsImgInput").on("change",function(a){var i=new FormData,o=a.target.files||a.dataTransfer.files;for(var n in o)i.append("part"+n,o[n]);t.loading.open(),e.ajax({url:"http://"+window.configUrl.postPicsUrl+"/upload/house.html",type:"post",data:i,contentType:!1,processData:!1,cache:!1,success:function(a){if(a.code)return r.warn(a.file),!1;for(var i in a){var o={imgKey:a[i].sKey,imgExt:a[i].sExt};if(t.propertyPic.push(o),/^(png|jpe?g)$/.test(a[i].sExt)){var n="http://"+window.configUrl.viewUrl+"/view/house/"+a[i].sKey+"/900x675."+a[i].sExt,s=e('<div class="image-item"><img src="'+n+'"><a class="images-del">x</a><a class="preview-image">预览</a></div>');e(".credentials-upload-wrapper").before(s)}}},complete:function(){t.loading.hide()}})}),e("#proxyPicImg").on("click",function(){e("#proxyPicImgInput").trigger("click")}),e("#proxyPicImgInput").on("change",function(a){var i=new FormData,o=a.target.files||a.dataTransfer.files;for(var n in o)i.append("part"+n,o[n]);t.loading.open(),e.ajax({url:"http://"+window.configUrl.postPicsUrl+"/upload/house.html",type:"post",data:i,contentType:!1,processData:!1,cache:!1,success:function(a){if(a.code)return r.warn(a.file),!1;for(var i in a){var o={imgKey:a[i].sKey,imgExt:a[i].sExt};if(t.proxyPic.push(o),/^(png|jpe?g)$/.test(a[i].sExt)){var n="http://"+window.configUrl.viewUrl+"/view/house/"+a[i].sKey+"/900x675."+a[i].sExt,s=e('<div class="image-item"><img src="'+n+'"><a class="images-del">x</a><a class="preview-image">预览</a></div>');e(".proxyPicImg-upload-wrapper").before(s)}}},complete:function(){t.loading.hide()}})})},delImg:function(){var t=this;e(".pre-selectOwnerImg").on("click",".images-del",function(){var a=e(this).parent(".image-item"),i=a.index();t.propertyIdCardPic.splice(i,1),e("#selectOwnerImg1Input").val(""),a.remove()}),e("#House-img-uploader").on("click",".images-del",function(){var a=e(this).parent(".image-item"),i=a.index();t.pics.splice(i,1),e("#selectHouseImgInput").val(""),a.remove()}),e(".pre-selectCredentialsImg").on("click",".images-del",function(){var a=e(this).parent(".image-item"),i=a.index();t.propertyPic.splice(i,1),e("#selectCredentialsImgInput").val(""),a.remove()}),e(".pre-proxyPicImg").on("click",".images-del",function(){var a=e(this).parent(".image-item"),i=a.index();t.proxyPic.splice(i,1),e("#proxyPicImgInput").val(""),a.remove()}),e(".pre-selectHouseSaleContractProofPic").on("click",".images-del",function(){var a=e(this).parent(".image-item"),i=a.index();t.houseSaleContractProofPic.splice(i,1),e("#selectHouseSaleContractProofPicInput").val(""),a.remove()}),e(".pre-selectHouseDeliveryDescPic").on("click",".images-del",function(){var a=e(this).parent(".image-item"),i=a.index();t.houseDeliveryDescPic.splice(i,1),e("#selectHouseDeliveryDescPicInput").val(""),a.remove()})},hideContent:function(t){t?e(".hide-content").css("display","none"):e(".hide-content").css("display","block")},initMap:function(){var t=this,a=new BMap.Map("axg-map"),i=new BMap.Point(108.373029,22.822608);a.enableScrollWheelZoom(),a.enableContinuousZoom(),a.centerAndZoom(i,20);var o=new BMap.ScaleControl({anchor:BMAP_ANCHOR_TOP_LEFT}),n=new BMap.NavigationControl;a.addControl(o),a.addControl(n);var s=new BMap.Marker(i);a.addOverlay(s),s.enableDragging(),s.addEventListener("dragend",function(){});var c=new BMap.LocalSearch(a);c.enableAutoViewport(),e("#reSearch").on("click",function(){var e=document.getElementById("creAddress").value;if(""==e)return r.warn("请输入具体地址"),!1;a.clearOverlays();var i=new BMap.Geocoder;i.getPoint(e,function(e){if(e){t.config.postPoint={},t.config.postPoint=e,a.centerAndZoom(e,16);var i=new BMap.Marker(e);a.addOverlay(i),i.enableDragging(),i.addEventListener("dragend",function(){})}else r.warn("您选择地址没有解析到结果!")},t.config.city)})},bindEvents:function(){var t=this;e(".icon-close_ic").on("click",function(){e(".tip-wrapper").hide()}),e(".rightProofType").on("change",function(){t.rightProofTypeRely()}),e("body").on("click","#getHouseInfoBtn",function(){if(!e(".rightProofType").val())return r.warn("请选择所有权利证明类型",2e3),!1;if(!e(".ownerNum").val())return r.warn("请输入所有权利编号",2e3),!1;e(".get-houseInfo-btn").css("background","#E1E1E1").attr("disabled","disabled"),t.hideContent(!1);var a={propertyRightCardNo:t.firstOwnerNum,propertyRightName:t.firstOwnerName,rightProofType:e(".rightProofType option:checked").attr("rightprooftypeindex"),enterpriseArea:e(".enterpriseArea option:checked").attr("enterpriseareaindex"),propertyRightNo:e(".ownerNum").val()};e.ajax({url:window.configUrl.getHouseInfoUrl,contentType:"application/json; charset=UTF-8",type:"post",data:JSON.stringify(a),dataType:"json",success:function(a){if(a.success){if(a.data.houseNumber){if(e(".fail-tip").hide(),e(".success-tip").show(),t.houseNumber=a.data.houseNumber,t.locationName=a.data.locationName,t.street=a.data.street,e(".owner-add-wrapper").hide(),e("#owner").children("div").eq(0).siblings("div").remove(),t.config.ownerIndex=1,a.data.govCrpInfos.length>0){t.isTake=!1,t.crpInfo=a.data.govCrpInfos;for(var i=0;i<a.data.govCrpInfos.length;i++)e("#addOwner").trigger("click"),e(".owner-wrapper").eq(i).find(".rightProofType-crp").get(0).selectedIndex=a.data.govCrpInfos[i].propertyType,t.crpInfo[i].rightProofType=a.data.govCrpInfos[i].propertyType,e(".owner-wrapper").eq(i).find(".propertyrightno").val(a.data.govCrpInfos[i].propertyRightNo),t.crpInfo[i].propertyRightNo=a.data.govCrpInfos[i].propertyRightNo,e(".owner-wrapper").eq(i).find(".ownerInputName").val(a.data.govCrpInfos[i].propertyRightName),t.crpInfo[i].name=a.data.govCrpInfos[i].propertyRightName,e(".owner-wrapper").eq(i).find(".ownerInputNum").val(a.data.govCrpInfos[i].propertyRightCardNo),t.crpInfo[i].idcard=a.data.govCrpInfos[i].propertyRightCardNo,e(".owner-wrapper").eq(i).find(".ownerInputMobile").val(a.data.govCrpInfos[i].propertyRightMobile),t.crpInfo[i].mobile=a.data.govCrpInfos[i].propertyRightMobile,t.crpInfo[i].pics=[],e(".crpStatus input[name='ownerOne']:checked").val(1),i==a.data.govCrpInfos.length-1&&(t.isTake=!0);e(".delete-wrapper").hide()}e(".container-top-rightProofType").hide(),e(".rightProofType-crp").attr("disabled","disabled"),e(".propertyrightno").attr("disabled","disabled"),e(".ownerInputName").attr("disabled","disabled"),e(".ownerInputNum").attr("disabled","disabled"),e(".houseSpace").val(a.data.houseSpace/100),e(".houseSpace").attr("disabled","disabled"),e(".space").val(a.data.space/100),e(".space").attr("disabled","disabled"),e(".address-detail").val(a.data.houseLocation),e(".address-detail").attr("disabled","disabled"),e(".enterpriseArea").find("option[enterpriseareaindex="+a.data.houseLocationEnum+"]").attr("selected","selected"),e(".natureLand").find("option[naturelandindex="+a.data.natureLand+"]").attr("selected","selected"),-1!=a.data.natureLand&&e(".natureLand").attr("disabled","disabled"),null!==a.data.govCrpInfo&&a.data.govCrpInfo.propertyType&&(e(".propertyType").find("option[propertytypeindex="+a.data.govCrpInfo.propertyType+"]").attr("selected","selected"),e(".propertyType").attr("disabled","disabled")),e(".rightProofType").attr("disabled","disabled"),e(".enterpriseArea").attr("disabled","disabled"),e(".ownerNum").attr("disabled","disabled"),a.data.govCrpInfos.length>0&&e(".proxy").show(),e(".buildingNo").val(a.data.geteNo),e(".buildingNo").attr("disabled","disabled"),e(".unitNo").val(a.data.buildingNo),e(".unitNo").attr("disabled","disabled"),e(".roomNo").val(a.data.roomNo),e(".roomNo").attr("disabled","disabled")}}else e(".success-tip").hide(),e(".fail-tip").show(),e(".get-houseInfo-btn").css("background","#309de5").removeAttr("disabled")},error:function(){e(".success-tip").hide(),e(".fail-tip").show(),e(".get-houseInfo-btn").css("background","#309de5").removeAttr("disabled")}})}),e(".houseSpace").on("blur",function(){var t=e(".space").val();""==e(this).val()?(r.warn("套内面积不能为空"),e(this).val("")):""!=t?parseFloat(e(this).val())>parseFloat(t)&&(r.warn("套内面积应小于等于建筑面积"),e(this).val("")):(r.warn("建筑面积不能为空"),e(this).val(""))}),e.ajax({url:window.configUrl.userInfo,type:"get",dataType:"json",success:function(a){a.success?a.data.identityCardFrontKey&&a.data.identityCardBackKey?(t.firstOwnerName=a.data.name,t.firstOwnerNum=a.data.identity,t.firstOwnerMobile=a.data.mobile,e(".firstOwnerName").html(a.data.name),e(".firstOwnerNum").html(a.data.identity),e(".firstOwnerMobile").html(a.data.mobile)):e("#check_modal").dialog("instance").open():console.log(a.code)}}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),e(".villageBtn").on("click",function(){e(".select-village-wrapper").dialog("instance").open()}),e(".select-village-wrapper").on("click",".close-btn",function(){e("#select-village").dialog("instance").close()}),e(".editVillage").on("keyup",function(){e.ajax({url:window.configUrl.suggestUrl,type:"get",data:{name:e(".editVillage").val()},dataType:"json",success:function(a){if(t.communityId="",0==a.errorCode)if(e(".list-ul").children().remove(),0!=a.data.total){t.liArr.splice(0,t.liArr.length);for(var i=0;i<a.data.list.length;i++){var r="<li><p>"+a.data.list[i].communityName+"</p><span>"+a.data.list[i].communityId+"</span></li>";t.liArr.push(r)}e(".list-ul").append(t.liArr).show()}else 0==a.data.total&&(t.liArr.splice(0,t.liArr.length),e(".list-ul").hide())}})}),e(".list-ul").on("click","li",function(){t.communityId="";var a=e(this).find("span").html();t.communityId=a;var i=e(this).find("p").html();e(".editVillage").val(i),e(".list-ul").children().remove(),t.liArr.splice(0,t.liArr.length),e(".list-ul").hide()}),e("#click_create").on("click",function(){e("#create-village").dialog("instance").open(),e("#select-village").dialog("instance").close(),t.initMap(),e.ajax({url:window.configUrl.cityUrl,type:"get",dataType:"json",success:function(t){if(t.success){var a=t.data.district,i=t.data.block;for(var r in a){var o='<option districtId="'+a[r].id+'" blockId="'+i[r][0].id+'">'+a[r].name+"</option>";e(".creArea").append(o)}}else console.log(t.code)}})}),e(".create-village-wrapper").on("click",".close-btn",function(){e(".creArea").text(""),e(".creArea").append('<option value="">请选择</option>'),e("#create-village").dialog("instance").close(),e("#select-village").dialog("instance").open()}),e(".create-village-wrapper").on("click",".addBtn",function(){if(""==e(".creVillage").val().trim())r.warn("请填写小区");else if("0"==e("option:selected",".creArea").index())r.warn("请选择区域");else if(""==e("#creAddress").val().trim())r.warn("请填写具体地址");else if("{}"==JSON.stringify(t.config.postPoint))r.warn("请点击搜索以确定位置");else{var a={name:e(".creVillage").val(),address:e("#creAddress").val(),latitude:t.config.postPoint.lat,longitude:t.config.postPoint.lng,blockId:e("option:selected",".creArea").attr("blockId"),districtId:e("option:selected",".creArea").attr("districtId")};e.ajax({url:window.configUrl.createVillageUrl,type:"post",contentType:"application/json; charset=UTF-8",data:JSON.stringify(a),dataType:"json",success:function(t){t.success?(r.success("新建小区成功，请等待审核"),e("#create-village").dialog("instance").close(),e("#select-village").dialog("instance").close()):r.warn(t.msg)}})}}),e(".create-village-wrapper").on("click",".calBtn",function(){e(".creArea").text(""),e(".creArea").append('<option value="">请选择</option>'),e("#create-village").dialog("instance").close(),e("#select-village").dialog("instance").open()}),e("#select-village").on("click",".addBtn",function(){var a=e(".editVillage").val().replace(/\s+/g,"");""==a||""==t.communityId?(e(".editVillage").focus().val(""),r.warn("选择一个小区")):(e(".villageProcess").hide(),e(".villageAddressText").html(a),e(".villageAddress").show(),e("#select-village").dialog("instance").close(),e("#villageBtn").html("修改小区"))}).on("click",".calBtn",function(){e("#select-village").dialog("instance").close()}),e("#closeTips").on("click",function(){e(".smallTip").hide()}),e("#insureBack").on("click",".close-btn",function(){e("#insureBack").dialog("instance").close()}).on("click",".cancel-btn",function(){e("#insureBack").dialog("instance").close()}).on("click",".confirm-btn",function(){window.history.back(-1)}),e(".back").on("click",function(){e(".insure-dialog").dialog("instance").open()}),e("input:radio[name='ownerOne']").change(function(){e("#ownerIsOverOne").is(":checked")?(e(this).attr("checked","checked"),e(this).siblings().removeAttr("checked"),e("#addOwner").show(),e("#owner-wrapper").siblings().show(),e(".proxy").show()):e("#ownerIsOne").is(":checked")&&(e(this).attr("checked","checked"),e(this).siblings().removeAttr("checked"),e("#addOwner").hide(),e("#owner-wrapper").siblings().hide(),e(".proxy").hide())}),e(".aditional-owner-msg").on("change",".rightProofType-crp",function(){var a=e(this).parent().parent().parent().parent().parent().parent().index()-1;t.crpInfo[a].rightProofType=e(this).find("option:checked").attr("rightprooftypeindex")}),e(".aditional-owner-msg").on("change",".propertyrightno",function(){var a=e(this).parent().parent().parent().parent().parent().index()-1;t.crpInfo[a].propertyRightNo=e(this).val()}),e(".aditional-owner-msg").on("change",".ownerInputName",function(){var a=e(this).parent().parent().parent().parent().parent().index()-1;t.crpInfo[a].name=e(this).val()}),e(".aditional-owner-msg").on("change",".ownerInputNum",function(){var a=e(this).parent().parent().parent().parent().parent().index()-1;t.crpInfo[a].idcard=e(this).val()}),e(".aditional-owner-msg").on("change",".ownerInputMobile",function(){var a=e(this).parent().parent().parent().parent().parent().index()-1;t.crpInfo[a].mobile=e(this).val()}),e("#download_proxyPic").on("click",function(){e.ajax({url:"/web/goverp/api/attachment",type:"get",dataType:"json",success:function(e){if(e.success){var t=e.data.proxyDownUrl;window.open(t)}else console.log(e.code)}})}),e(".sub").on("click",function(){if(!n){var a=[],i=[],o=[],s=0,c=0,l=0,p=e(".tags input[type='checkbox']"),d=e(".collocation input[type='checkbox']"),u=e(".landlordRequest input[type='checkbox']");for(s in p)p[s].checked&&a.push(p.eq(s).attr("housetagindex"));for(c in d)d[c].checked&&i.push(d.eq(c).attr("housecollocationindex"));for(l in u)u[l].checked&&o.push(u.eq(l).attr("landlordrequestindex"));var g=parseInt(e(".crpStatus input[name='ownerOne']:checked").val()),f={houseNumber:t.houseNumber||"",street:t.street,houseLocation:e(".address-detail").val(),houseLocationEnum:e(".enterpriseArea option:checked").attr("enterpriseareaindex"),rightProofType:e(".rightProofType option:checked").attr("rightprooftypeindex"),houseSaleContractProofPic:t.houseSaleContractProofPic||[],houseDeliveryDescPic:t.houseDeliveryDescPic||[],propertyRightName:t.firstOwnerName,propertyRightCardNo:t.firstOwnerNum,propertyRightMobile:t.firstOwnerMobile,propertyIdCardPic:t.propertyIdCardPic||[],communityId:t.communityId,communityName:e(".villageAddressText").text(),buildingNo:e(".buildingNo").val(),unitNo:e(".unitNo").val(),roomNo:e(".roomNo").val(),inFloor:parseInt(e(".inFloor").val()),totalFloor:parseInt(e(".totalFloor").val()),roomNum:parseInt(e(".roomNum").val()),hallNum:parseInt(e(".hallNum").val()),toiletNum:parseInt(e(".toiletNum").val()),space:parseInt(100*e(".space").val()),houseSpace:parseInt(100*e(".houseSpace").val()),situation:e("option:selected",".situation").attr("situationindex"),toward:e("option:selected",".toward").attr("towardIndex"),tags:a,collocation:i,landlordRequest:o,desc:e(".desc").val(),rentPrice:parseInt(100*e(".rentMoney").val()),paymentWay:e("option:selected",".paymentWay").attr("paymentwayindex"),rentType:e("option:selected",".rentType").attr("renttypeindex"),rentPosition:e(".rentPosition").val(),mobile:e(".contactPhone").val(),propertyRightNo:e(".ownerNum").val(),natureLand:e("option:selected",".natureLand").attr("naturelandindex"),crpStatus:g,crpInfo:0===g?null:t.crpInfo,pics:t.pics,propertyPic:t.propertyPic,commonOwnerOpinion:t.proxyPic,sourceType:3,id:window.configUrl.id||"",propertyType:e(".propertyType option:checked").attr("propertytypeindex")};if(""==e(".ownerNum").val())return r.warn("请填写所有权证号"),!1;if(""==e(".natureLand").val())return r.warn("请选择房屋用途"),!1;if(f.crpInfo)for(var c=0;c<f.crpInfo.length;c++)if((""==f.crpInfo[c].rightProofType||0===f.crpInfo[c].pics.length||""==f.crpInfo[c].propertyRightNo||""==f.crpInfo[c].name||""==f.crpInfo[c].idcard||""==f.crpInfo[c].mobile)&&1==f.crpStatus)return r.warn("请填写完整共有权利人信息"),!1;if(""==e(".unitNo").val())return r.warn("请填写房源楼栋号"),!1;var v=e(".space").val(),h=e(".houseSpace").val();return""==h?(r.warn("套内面积不能为空"),e(".houseSpace").val(""),!1):""==v?(r.warn("建筑面积不能为空"),e(".houseSpace").val(""),!1):parseFloat(h)>parseFloat(v)?(r.warn("套内面积小于等于建筑面积"),e(".houseSpace").val(""),!1):void t.housePublish(f)}}),e(".user-right").on("mouseover mouseout",".pre .image-item",function(){"mouseover"==event.type?e(this).find(".preview-image").show():"mouseout"==event.type&&e(this).find(".preview-image").hide()}),e(".user-right").on("click",".pre .preview-image",function(){e(".big-wrap").show();var t=e(this).parent(".image-item").find("img").attr("src");e(".big-wrap").find("img").attr("src",t)}),e(".close-wrap").on("click",function(){e(".big-wrap").hide()})},openNotice:function(){e("#container-notice").dialog("instance").open(),e("#container-notice").on("click",".close-btn",function(){return e("#hasRead").is(":checked")?void e("#container-notice").dialog("instance").close():void r.warn("请确认已阅读内容！",3e3)}),e("#J_NoticeBtn").off("click").on("click",function(){return e("#hasRead").is(":checked")?void e("#container-notice").dialog("instance").close():void r.warn("请确认已阅读内容！",3e3)})},housePublish:function(t){var a=this;n=!0,e.ajax(""!=window.configUrl.id?{url:window.configUrl.houseEditFormUrl+window.configUrl.id,contentType:"application/json; charset=UTF-8",type:"POST",data:JSON.stringify(t),dataType:"json",success:function(e){e.success?(r.success("修改房源成功"),setTimeout(function(){location.href="/pc/user/verification/list"},300)):(n=!1,r.warn(null!=e.fieldErrors?e.fieldErrors[0].msg:e.msg))}}:{url:window.configUrl.houseFormUrl,type:"post",contentType:"application/json; charset=UTF-8",data:JSON.stringify(t),dataType:"json",success:function(e){e.success?a.houseNumber?(r.success("核验成功"),setTimeout(function(){location.href="/pc/user/verification/list"},300)):(r.success("您已发起房源核验，审核需要3至5个工作日。"),setTimeout(function(){location.href="/pc/user/verification/list"},2e3)):(n=!1,r.warn(null!=e.fieldErrors?e.fieldErrors[0].msg:e.msg))}})},imgUpload:function(t){var a=this,i=t-1;e("#selectOwnerImg1Input"+t).on("change",function(o){var n=new FormData,s=o.target.files||o.dataTransfer.files;for(var c in s)n.append("part"+c,s[c]);a.loading.open(),e.ajax({url:"http://"+window.configUrl.postPicsUrl+"/upload/house.html",type:"post",data:n,contentType:!1,processData:!1,cache:!1,success:function(o){if(o.code)return r.warn(o.file),!1;for(var n in o){if(a.crpInfo[i]&&a.crpInfo[i].pics[0]&&a.crpInfo[i].pics[0].imgKey){if(2==a.crpInfo[i].pics.length)return void r.warn("只能上传两张图片！");if(a.crpInfo[i].pics[0].imgKey==o[n].sKey)return void r.warn("请不要上传相同的图片！")}{var s={imgKey:o[n].sKey,imgExt:o[n].sExt};Array.isArray(a.crpInfo[i].pics)?a.crpInfo[i].pics:[]}if(a.crpInfo[i].pics.push(s),/^(png|jpe?g)$/.test(o[n].sExt)){e("#selectOwnerImg1Input"+t).val("");var c="http://"+window.configUrl.viewUrl+"/view/house/"+o[n].sKey+"/900x675."+o[n].sExt,l=e('<div class="image-item"><img src="'+c+'"><a class="images-del">x</a><a class="preview-image">预览</a></div>');e(".owner-upload-wrapper"+t).before(l)}}},complete:function(){a.loading.hide()}})})},imgDelete:function(t){var a=this,i=t-1;e(".pre-selectOwnerImg").on("click",".images-del",function(){var t=e(this).parent(".image-item"),r=t.index();e(this).parent().parent().find("input").val(""),a.crpInfo[i].pics.splice(r,1),t.remove()})}};s.init()})});