define("web:static/member/user/mySendRoom/mySendRoom.js",function(n){"use strict";n.async(["common:components/jquery/jquery.js","common:components/pcUI/dialog/dialog.js","common:components/pcUI/template/template.js","common:components/pcUI/pager/pager.js","common:components/pcUI/tips/tips.js"],function(n,t,a,e,i){var s={config:{mySendRoomList:"<%list.forEach(function(item) { %>\r\n	<li class='house-every-item' data-id= '<%= item.id %>'>\r\n		<dl class='detail-pic clearfix'>\r\n			<dt class='pic'>\r\n			    <a href='<%= item.upStatus ?  item[\"defaultWebUrl\"] : \"javascript:;\" %>'>\r\n					<img src=\"<%= item['pics'][0]['picUrl'] %>\" title='图片'>\r\n				</a>\r\n			</dt>\r\n			<dd class='detail clearfix'>\r\n				<div class='detail-left'>\r\n					<p class='title'>\r\n						<a href=\"<%= item.upStatus ?  item['defaultWebUrl'] : \"javascript:;\" %>\" class='<%= item.upStatus ?  \"\" : \"strike-through\" %>'><%=item['title']%></a>\r\n						<% if(item['auditStatus'] != '0' && item['auditStatus'] != '2'){ %>\r\n						<% if(item['houseIsMortgage']==1) { %>\r\n						    <span class=\"is-dy\">有抵押</span>\r\n						<%} else if(item['houseIsMortgage']==0){%>\r\n						    <span class=\"is-dy\">无抵押</span>\r\n						<% } %>\r\n						<% if(item['houseIsLimit']==1) { %>\r\n                             <span class=\"is-dy\">有限制</span>\r\n                        <%} else if(item['houseIsLimit']==0){%>\r\n                            <span class=\"is-dy\">无限制</span>\r\n                        <% } %>\r\n                        <% } %>\r\n					</p>\r\n					<p class='huxing'><%=item['rentType'] == 1 ? '整租&nbsp;·&nbsp;' : '合租&nbsp;·&nbsp;'%>\r\n					    <% if(item['roomNum'] != 0 || item['hallNum'] != 0 || item['toiletNum'] != 0){ %>\r\n                            <%= item['roomNum'] + '室' + item['hallNum'] + '厅' + item['toiletNum'] +'卫&nbsp;·&nbsp;'%>\r\n                        <% } %>\r\n						<%= item['space']/100 %>㎡</p>\r\n					<p class='location'><%=item['communityName']%>&nbsp;&nbsp; <%=item['communityAddress']%></p>\r\n					<p class='tags clearfix'>\r\n					    <% if (item['collocationName'] !== '') { %>\r\n					        <% item['collocationName'].split(',').forEach(function(collocationName){ %>\r\n                                <span><%= collocationName %></span>\r\n                            <%})%>\r\n                        <% } %>\r\n					</p>\r\n					<% if(item['auditStatus'] == '1'){ %>\r\n					<p class=\"fangdong clearfix\">\r\n						<% if(item['govHouseNumber'] != null){ %>\r\n						<img src=\"<%= yhy_img %>\">\r\n						<span class=\"yhy\">已核验</span>\r\n						<% } %>\r\n					</p>\r\n					<% } %>\r\n					<%if(item['logoUrl'] || item['brandName']) { %>\r\n					<span class='brand'>\r\n					    <%if(item['logoUrl'] && !item['brandName']) { %>\r\n					    	<img src=\"<%= item['logoUrl'] %>\">\r\n						<% } else { %>\r\n							<%=item['brandName']%>\r\n						<% } %>\r\n					</span>\r\n					<%}%>\r\n\r\n					<div class='detail-right'>\r\n						<% if(item['auditStatus'] == '0'){ %>\r\n						<p class=\"state shenhezhong\">\r\n							<span>审核中</span>\r\n						</p>\r\n\r\n						<%} %>\r\n						<% if(item['auditStatus'] == '1'&& item['upStatus'] == '2'){ %>\r\n						<p class=\"state yishangjia\">\r\n							<span>已上架</span>\r\n						</p>\r\n\r\n						<%} %>\r\n						<% if(item['auditStatus'] == '2'){ %>\r\n						<p class=\"state shenhebohui\">\r\n							<span title=\"<%= item['reason'] %>\">审核驳回</span>\r\n						</p>\r\n						<%} %>\r\n\r\n                       <% if (item['auditStatus'] == '1' && item['upStatus'] == '0') { %>\r\n                            <p class=\"state yixiajia\">\r\n                                <% if (item['pattern'] === 1) { %>\r\n                                    <span title='该房源已备案，如需上架请重新编辑后发布'>已下架</span>\r\n                                <% } else { %>\r\n                                    <span>已下架</span>\r\n                                <% } %>\r\n                             </p>\r\n                        <% } %>\r\n\r\n						<p class='price'><strong class='<%= item.auditStatus == 2?  \"change-gray\" : \"\" %>'><%= item['rentPrice'] ? item['rentPrice']/100:'' %></strong class='<%= item.auditStatus == 2?  \"change-gray\" : \"\" %>'><span>元/月</span></p>\r\n					</div>\r\n\r\n					<p class=\"handle uploadContract\">\r\n						<span>上传合同</span>\r\n					</p>\r\n\r\n                    <% if (item['upStatus'] === '2'){ %>\r\n                        <p class=\"handle pullHouse\">\r\n                            <span>下架房源</span>\r\n                        </p>\r\n                    <% } else if (item['upStatus'] === '0') { %>\r\n                        <% if(item['auditStatus'] === '1' && item['pattern'] !== 2 && !item['hasRecord']){ %>\r\n                            <p class=\"handle editHoude\">\r\n                                <span>编辑</span>\r\n                            </p>\r\n                        <% } %>\r\n                    <% } %>\r\n\r\n				</div>\r\n			</dd>\r\n		</dl>\r\n	</li>\r\n<% }) %>\r\n",currentPage:1,pageSize:20,total:0,index:0,currentSize:1},init:function(){n(".dialog-wrapper").dialog({customWraper:!0}),this.initAjax(),this.bindEvents(),this.initImg()},initAjax:function(){var t=this;this.config.currentPage=this.getQueryParam("page")||1;var e={page:t.config.currentPage,pageSize:t.config.pageSize},i=t.config.mySendRoomList;n.ajax({url:window.configPager.mySendRoomUrl,type:"get",data:e,dataType:"json",success:function(e){if(0==e.errorCode){var s=e.data.list,r=Math.ceil(e.data.total/t.config.pageSize);t.config.total=r,s.length?(r>1&&t.pagination(),n(".have-data").html(a.parse(i,{list:s}))):n(".no-data").removeClass("hide")}}})},bindEvents:function(){n(".have-data").on("click",".pullHouse",function(){var t=this,a=n(t).parent().parent().parent().parent().attr("data-id");n(".pullHouse-wrapper").dialog("instance").open(),n("#pullHouse-wrapper").on("click",".btns-sure",function(){n.ajax({url:"/web/goverp/api/house/"+a+"/shelf/down",type:"POST",dataType:"json",success:function(t){console.log(t),t.success?(n("#pullHouse-wrapper").dialog("instance").close(),i.show("下架成功"),setTimeout(function(){location.reload()},300)):(i.show(t.msg),setTimeout(function(){location.reload()},300))}})})}),n(".have-data").on("click",".editHoude",function(){var t=this,a=n(t).parent().parent().parent().parent().attr("data-id");n.ajax({url:"/web/goverp/api/house/"+a,type:"get",data:{id:a},success:function(n){console.log(n),n.success?(i.show("跳转编辑页面成功"),setTimeout(function(){location.href="/pc/publishHouse/edit?id="+a},300)):(i.show("跳转编辑页面失败"),setTimeout(function(){location.reload()},300))}})}),n(".have-data").on("click",".uploadContract",function(){var t=this,a=n(t).parent().parent().parent().parent().attr("data-id");n.ajax({url:"/web/goverp/api/house/"+a+"/contract",type:"get",data:{id:a},success:function(n){console.log(n),n.success?(i.show("跳转上传合同页面成功"),setTimeout(function(){location.href="/pc/contract/upload.html?id="+a},300)):(i.show("跳转上传合同页面失败"),setTimeout(function(){location.reload()},300))}})}),n("#pullHouse-wrapper").on("click",".close-btn",function(){n("#pullHouse-wrapper").dialog("instance").close()}).on("click",".btns-cal",function(){n("#pullHouse-wrapper").dialog("instance").close()})},initImg:function(){n(".mySendRoom-wrapper .pic img").each(function(){var t=n(this);t.height()>t.width()?(t.height("auto !important"),t.width("100%")):(t.width("auto !important"),t.height("100%"))})},getQueryParam:function(n){var t=new RegExp("(^|&)"+n+"=([^&]*)(&|$)","i"),a=window.location.search.substr(1).match(t);return null!=a?unescape(a[2]):null},pagination:function(){{var t=this;n("#J_pagenation").pager({pageTotal:t.config.total,currentPage:t.config.currentPage,perPage:t.config.pageSize,className:"pagination-box",currentClassName:"current-pager"}).on("pager:switch",function(t,a){n(".ui2-pager-current").html();var e=location.search,i=/page\=[^&]+/,s=null;e&&i.test(e)&&(s=location.pathname+e.replace(i,"page="+a)),e||(s=location.pathname+"?page="+a),e&&!i.test(e)&&(s=location.href+"&page="+a),location.href=s})}this.paginationPosition()},paginationPosition:function(){var t=0;n(".pagination-box li").each(function(){t+=n(this).outerHeight()+13}),n(".pagination-box").width(t)}};s.init()})});