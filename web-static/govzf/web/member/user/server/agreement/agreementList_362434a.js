define("web:static/member/user/server/agreement/agreementList.js",function(a){"use strict";a.async(["common:components/jquery/jquery.js","common:components/pcUI/pager/pager.js","common:components/pcUI/tips/tips.js"],function(a,e,t){var i=!1,n={config:{list_ul:[],currentPage:1,pageSize:10,total:0},init:function(){this.initAjax()},initAjax:function(){var e=this;e.config.currentPage=e.getQueryParam("page")||1;var i={fillingType:"1",from:"c",page:e.config.currentPage,pageSize:e.config.pageSize};a.ajax({url:window.configPager.fillingListUrl,type:"get",data:i,dataType:"json",success:function(i){if(i.success)if(i.data.total>0){var n=Math.ceil(i.data.total/e.config.pageSize),c=i.data.list.length;if(e.config.total=n,c){n>1&&e.pagination();for(var s=0;c>s;s++){var o=i.data.list[s],l=0!=o.houseId?!0:!1,r=1==o.isCrp?!0:!1,d=(o.isAck,o.isOwner),u="",g="",p=o.status,f="";"1"==p?f="未备案":"1011"==p||"4004"==p?(f="待房源核验",g=1==d?'<a class="ri" href="/pc/user/beian/detail?id='+o.id+'">房源核验</a><a class="cancelHeyan" data-id="'+o.id+'">取消核验</a>':'<a class="cancelBeian" data-id="'+o.id+'" data-type="1">取消备案</a>'):"2"==p?(f="备案中",l=!0):"2013"==p||"2015"==p||"2016"==p?f="已失效":"2012"==p||"2014"==p?f="已取消备案":"3"==p||"3001"==p||"3002"==p||"3003"==p||"6"==p||"4002"==p?(f="已备案",g=r&&"6"!=p?"":'<a href="/pc/user/beian/agreementStatus?id='+i.data.list[s].id+'">申请注销</a>'):"4"==p?f="备案失败":"4001"==p||"4003"==p?(f="待确认",1==d&&!r||1==o.isAck||(g='<a class="ri" href="/pc/user/beian/agreementStatus?id='+i.data.list[s].id+'">确认备案</a><a href="/pc/user/beian/agreementStatus?id='+i.data.list[s].id+'">取消备案</a>')):"5"==p||"5001"==p?f="已注销":"7"==p||"7001"==p?(f="备案注销中",1!=o.isAck&&(g='<a class="ri" href="/pc/user/beian/agreementStatus?id='+i.data.list[s].id+'">确认注销</a><a href="/pc/user/beian/agreementStatus?id='+i.data.list[s].id+'">拒绝注销</a>')):"8"==p&&(f="待注销"),u=l?'<a href="/pc/user/beian/agreementStatus?id='+i.data.list[s].id+'">'+i.data.list[s].contractNo+"</a>":"<p>"+i.data.list[s].contractNo+"</p>";var h='<ul class="clearfix"><li>'+u+"</li><li>"+(i.data.list[s].contractStartTime||"--")+"</li><li>"+(i.data.list[s].contractEndTime||"--")+"</li><li>"+(i.data.list[s].houseAddress||"--")+"</li><li>"+i.data.list[s].tenantPerson+"</li><li>"+i.data.list[s].ownerPerson+"</li><li>"+i.data.list[s].createTime.split(" ")[0]+"</li><li>"+f+"</li><li>"+g+"</li></ul>";e.config.list_ul.push(h)}a(".agreement-container").append(e.config.list_ul),e.bindEvents()}}else{var m='<div class="noneList"><span></span><p>您还没有合同备案</p></div>';a(".agreement-list").html(m)}else t.show(i.msg)}})},bindEvents:function(){var e="",n=0;a(".close-btn").on("click",function(){a("#cancelHeyanToast").hide(),a("#cancelBeianToast").hide()}),a(".cancelHeyan").on("click",function(){e=a(this).attr("data-id"),a("#cancelHeyanToast").show()}),a("#cancelHeyanToast .confirm-button").on("click",function(){i||(i=!0,a.ajax({url:window.configPager.verifyCancel+e,type:"get",dataType:"json",success:function(e){e.success?(t.show("取消成功"),a("#cancelHeyanToast").hide(),window.location.reload()):(t.show(e.msg),a("#cancelHeyanToast").hide(),i=!1)}}))}),a("#cancelHeyanToast .cancel-button").on("click",function(){a("#cancelHeyanToast").hide()}),a(".cancelBeian").on("click",function(){e=a(this).attr("data-id"),n=a(this).attr("data-type"),a("#cancelBeianToast").show()}),a("#cancelBeianToast .confirm-button").on("click",function(){i||(i=!0,a.ajax({url:n?window.configPager.verifyCancel+e:window.configPager.recordCancel+e,type:"get",dataType:"json",success:function(e){e.success?(t.show("取消成功"),a("#cancelBeianToast").hide(),window.location.reload()):(t.show(e.msg),a("#cancelBeianToast").hide(),i=!1)}}))}),a("#cancelBeianToast .cancel-button").on("click",function(){a("#cancelBeianToast").hide()})},pagination:function(){{var e=this;a("#J_pagenation").pager({pageTotal:e.config.total,currentPage:e.config.currentPage,perPage:e.config.pageSize,className:"pagination-box",currentClassName:"current-pager"}).on("pager:switch",function(e,t){a(".ui2-pager-current").html();var i=location.search,n=/page\=[^&]+/,c=null;i&&n.test(i)&&(c=location.pathname+i.replace(n,"page="+t)),i||(c=location.pathname+"?page="+t),i&&!n.test(i)&&(c=location.href+"&page="+t),location.href=c})}this.paginationPosition()},paginationPosition:function(){var e=0;a(".pagination-box li").each(function(){e+=a(this).outerHeight()+13}),a(".pagination-box").width(e)},getQueryParam:function(a){var e=new RegExp("(^|&)"+a+"=([^&]*)(&|$)","i"),t=window.location.search.substr(1).match(e);return null!=t?unescape(t[2]):null}};n.init()})});