define("web:static/member/user/schedule/index.js",function(e){"use strict";e.async(["common:components/jquery/jquery.js","common:components/ui/zepto/zepto.js","common:components/pcUI/dialog/dialog.js","common:components/pcUI/template/template.js","common:components/third-party/lazyload/lazyload.js","common:components/pcUI/tips/tips.js","common:components/ui/getQueryString/getQueryString.js"],function(e,t,n,a,s,i,r){function l(t,n,a,s,i){e.ajax({url:t,type:n||"get",data:a,dataType:"json",success:function(e){e.success?s&&s(e):console.log(e)},error:function(){loading.hide(),console.log("接口获取失败！"),i&&i()}})}var c={config:{listTpl:"<%\r\nvar className = 'over', week = ['周日', '周一', '周二', '周三', '周四', '周五', '周六'];\r\nvar nowTime = (new Date()).getTime();\r\n\r\nif ( type==1 && (list.tenantStatus != 3 && list.tenantStatus != 6 && list.tenantStatus != 7)){\r\n    className = '';\r\n}else if(type==2 && (list.tenantStatus != 3 && list.tenantStatus != 6 && list.tenantStatus != 7)){\r\n    className = '';\r\n};\r\nif(list.tenantStatusDesc == '已结束'){\r\n    className = 'over';\r\n}\r\n\r\nvar layoutCollocation = { 1:'冰箱',2: \"电视机\",3: \"空调\",4: \"微波炉\",5: \"洗衣机\",6: \"床\",7: \"宽带\",8: \"桌子\",9: \"热水器\",10: \"衣柜\",11: \"煤气\",12: \"沙发\",13: \"电梯\",14: \"厨房\",15: \"浴室\",16: \"智能门锁\",17: \"对讲门铃\",18: \"储物柜\",19: \"免费WiFi\",20: \"燃气灶\",21: \"电磁炉\" ,22: \"卫生间\"};\r\n\r\nvar _date = new Date(list.reserveDate);\r\nvar Y = _date.getFullYear();\r\nvar M = (_date.getMonth() + 1) < 10 ? '0' + (_date.getMonth() + 1) : _date.getMonth() + 1;\r\nvar D = _date.getDate() < 10 ? '0' + _date.getDate() : _date.getDate();\r\nvar h = _date.getHours() < 10 ? '0' + _date.getHours() : _date.getHours();\r\nvar m = _date.getMinutes() < 10 ? '0' + _date.getMinutes() : _date.getMinutes();\r\nvar w = _date.getDay();\r\nvar imgUrl = list.coverMedia && list.coverMedia.url || '';\r\nvar imgKey = imgUrl && imgUrl.split(',')[0] || '';\r\nvar imgExt = imgUrl && imgUrl.split(',')[1] || '';\r\n%>\r\n\r\n<div class=\"account-wrapper schedule-wrapper\">\r\n    <h2>\r\n        <em class=\"iconfont icon-search_history\"></em>\r\n        <% if(list.reserveDate) { %>\r\n        <%= Y + '-' + M + '-' + D %> <%= week[w] %> <%= h + ':' + m %>\r\n        <% } else { %>\r\n        随时看房\r\n        <% } %>\r\n        <em class=\"iconfont icon-search_location ml-40\"></em>\r\n        <%= list.houseDetail && list.houseDetail.communityAddress || '' %>\r\n        <% if(type==1){ %>\r\n            <span class=\"status <%= className %>\"><%= list.tenantStatusDesc %></span>\r\n        <% }else if(type==2){ %>\r\n            <span class=\"status <%= className %>\"><%= list.tenantStatusDesc %></span>\r\n        <% } %>\r\n    </h2>\r\n    <div class=\"account-content\">\r\n        <p class=\"tit clearfix\">\r\n            <% if(type==1){ %>\r\n                <span class=\"fl-left\"><%= list.contactDesc %>：<%= list.agencyMobile || (list.houseDetail && list.houseDetail.mobile) || '' %></span>\r\n            <% }else if(type==2){ %>\r\n                <span class=\"fl-left\">看房人：<%= list.name || '匿名用户' %>&nbsp;&nbsp;手机：<%= list.mobile|| '' %></span>\r\n            <% } %>\r\n\r\n            <% if(list.channel == 'boyu') { %>\r\n            <a href='/web/contract/boyu/jump?target=5&roomTypeId=<%= list.external_number %>' class=\"fl-right\"\r\n               data-id='<%= list.id %>'>取消预约</a>\r\n            <% } else { %>\r\n                <% if(type==1 && (list.tenantStatus == 0 || list.tenantStatus == 1 || list.tenantStatus == 2 || list.tenantStatus == 4 ) && list.tenantStatusDesc != '已结束') { %>\r\n                    <a href='javascript:;' class=\"fl-right J_cancel_btn\" data-id='<%= list.id %>'>取消预约</a>\r\n                <% }else if(type==2 && (list.tenantStatusDesc != '已结束' || list.tenantStatusDesc == '已带看')){ %>\r\n                    <% if( list.tenantStatusDesc == '待看房'){ %>\r\n                        <a href='javascript:;' class=\"fl-right F_accept_btn\" data-id='<%= list.id %>'>确认带看</a>\r\n                    <% }else if(list.tenantStatusDesc == '预约申请中'){ %>\r\n                        <a href='javascript:;' class=\"fl-right F_cancel_btn\" data-id='<%= list.id %>'>取消预约</a>\r\n                    <% }else if(list.tenantStatusDesc == '待确认'){ %>\r\n                        <a href='javascript:;' class=\"fl-right F_cancel_btn\" data-id='<%= list.id %>'>拒绝预约</a>\r\n                        <a href='javascript:;' class=\"fl-right F_revise_btn mr_10\" data-id='<%= list.id %>'>修改时间</a>\r\n                        <a href='javascript:;' class=\"fl-right F_sure_btn mr_10\" data-id='<%= list.id %>'>接受预约</a>\r\n                    <% } %>\r\n                 <% } %>\r\n            <% } %>\r\n        </p>\r\n        <div class=\"house-every-item\">\r\n            <dl class=\"detail-pic clearfix\">\r\n                <dt class=\"pic\">\r\n                    <% if(imgKey) { %>\r\n                    <img class=\"lazy\"\r\n                         data-original=\"<%= viewUrl %>/<%= imgKey %>/640x360_gov.<%= imgExt %>\"\r\n                         src=\"<%= default_img %>\">\r\n                    <% } else { %>\r\n                    <img src=\"<%= default_img %>\">\r\n                    <% } %>\r\n                </dt>\r\n                <dd class=\"detail clearfix\">\r\n                    <div class=\"detail-left\">\r\n                        <p class=\"title\">\r\n                            <a href=\"/pc/main/detail.id.<%= list.jumpUrl %>.html\"><%= list.reserveHouse\r\n                                %></a>\r\n                        </p>\r\n\r\n                        <p class=\"huxing\">\r\n                            <% if(list.houseDetail && list.houseDetail.rentType==1){ %>\r\n                            <span>整租</span>\r\n                            <% }else{ %>\r\n                            <span>合租</span>\r\n                            <% } %>&nbsp;·&nbsp;\r\n                            <% if(list.houseLayout){ %>\r\n                            <span><%= list.houseLayout %></span>\r\n                            <% } %>&nbsp;·&nbsp;\r\n                            <%= list.houseDetail && parseFloat(list.houseDetail.space / 100) || '' %>㎡</p>\r\n                        <p class=\"location\">\r\n                            <%= list.houseDetail && list.houseDetail.communityAddress || '' %>\r\n                        </p>\r\n                        <p class=\"tags clearfix\">\r\n                            <% if(list['houseDetail'] && list['houseDetail']['collocation'] && list['houseDetail']['collocation'].length != '0' ){ %>\r\n                                <% list['houseDetail']['collocation'].forEach(function(collocation){ %>\r\n                                <span><%= layoutCollocation[collocation] %></span>\r\n                                <%})%>\r\n                            <% } %>\r\n                        </p>\r\n                        <% if(list.channel=='个人房源'){ %>\r\n                        <p class=\"fangdong clearfix\">\r\n                            <img src=\"<%= owner_img %>\">\r\n                            <span>认证房东</span>\r\n                        </p>\r\n                        <% } %>\r\n                        <div class=\"detail-right\">\r\n                            <p class=\"price\"><strong><%= list.houseDetail && list.houseDetail.rentPrice/100 || ''%></strong><span>元/月</span></p>\r\n                        </div>\r\n                    </div>\r\n                </dd>\r\n            </dl>\r\n        </div>\r\n    </div>\r\n</div>",sScheduleListUrl:"/web/tenant/reserve",sCancelTenantUrl:"/web/tenant/reserve/",loadImg:"//static.anhouse.com.cn/govzf/h5/member/common/imgs/img_loading_256_192_fbc87e2.png",pageNo:1,pageSize:15,tabType:r("type")?r("type"):1},init:function(){e(".dialog-wrapper").dialog({customWraper:!0});var t=this;t.bindEvent(),"1"==t.config.tabType?(e(".fangdong-wrapper").hide(),e(".zuke-wrapper").show()):"2"==t.config.tabType&&(e(".fangdong-wrapper").show(),e(".zuke-wrapper").hide()),e(".nav-child").eq(parseInt(t.config.tabType)-1).addClass("current").siblings().removeClass("current"),t.getScheduleList(t.config.tabType)},bindEvent:function(){var t=this;e(".zuke-wrapper").on("click",".J_cancel_btn",function(){var n=e(this).attr("data-id");console.log(n),e(".cancel-yuyue-wrapper").dialog("instance").open(),e("#cancel-yuyue").on("click",".sureBtn",function(){window.location.reload(),l(t.config.sCancelTenantUrl+n,"post","",function(){t.getScheduleList()})})}),e("#cancel-yuyue").on("click",".close-btn",function(){e(".cancel-yuyue-wrapper").dialog("instance").close()}).on("click",".calBtn",function(){e(".cancel-yuyue-wrapper").dialog("instance").close()}),e(".select-village-wrapper").on("click",".close-btn",function(){e("#select-village").dialog("instance").close()}),e(".nav-child").on("click",function(){var t=parseInt(e(this).index()+1);window.location.href="/pc/user/schedule/list?type="+t})},getScheduleList:function(n){var s=this;if("undefined"==typeof n)return!1;var r={pageNo:s.config.pageNo,pageSize:s.config.pageSize,tabType:n};e.ajax({url:s.config.sScheduleListUrl,type:"GET",data:r,success:function(r){if(r.success){var l=r.data.list,c=[];if(l.length){for(var o=0;o<l.length;o++){var p=l[o];console.log(p),c.push(a.parse(s.config.listTpl,{list:p,viewUrl:pageConfig.sHouseViewUrl,type:n}))}1==n?e("#J_schedule-wrapper").html(c.join("")):2==n&&e("#F_schedule-wrapper").html(c.join("")),t("img.lazy").lazyload()}else e(".no-data").removeClass("hide")}else i.show(r.msg)},error:function(){console.log("接口获取失败！")}})}};c.init()})});