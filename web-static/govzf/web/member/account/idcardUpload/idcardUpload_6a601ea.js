define("web:static/member/account/idcardUpload/idcardUpload.js",function(t){"use strict";t.async(["common:components/jquery/jquery.js","common:components/pcUI/cuteTips/cuteTips.js","common:components/ui/loading/loading.js"],function(t,i,n){var e={idcardPics:{backExt:"",backKey:"",fronExt:"",frontKey:""},init:function(){var t=this;t.loading=new n,t.initAjax(),t.bindEvents()},bindEvents:function(){var i=this;t(".tip-wrapper").on("click",".icon-close_ic",function(){t(this).parent(".tip-wrapper").hide()}),t(".idcard-main").on("change","#front_input, #back_input",function(t){var n=new FormData,e=t.target.files||t.dataTransfer.files;for(var a in e)n.append("part"+a,e[a]);var r="front_input"===t.target.id?"front":"back";i.loading.open(),i.uploadAjax(n,r)}),t(".idcard-main").on("click",".btn-add-front, .btn-front-update",function(){t("#front_input").trigger("click")}),t(".idcard-main").on("click",".btn-add-back, .btn-back-update",function(){t("#back_input").trigger("click")}),t(".user-right").on("mouseover mouseout",".pre .image-item",function(){"mouseover"==event.type?t(this).find(".preview-image").show():"mouseout"==event.type&&t(this).find(".preview-image").hide()}),t(".idcard-main").on("click",".btn-preview",function(){t(".big-wrap").show();var i=t(this).parent().parent().find("img").attr("src");t(".big-wrap").find("img").attr("src",i)}),t(".close-wrap").on("click",function(){t(".big-wrap").hide()}),t("#submit").on("click",function(){i.submitAjax()})},uploadAjax:function(n,e){var a=this;t.ajax({url:"http://"+window.configUrl.postPicsUrl+"/upload/house.html",type:"post",data:n,contentType:!1,processData:!1,cache:!1,success:function(n){if(n.code)return i.warn(n.file),!1;for(var r in n){if(a.idcardPics.frontKey==n[r].sKey||a.idcardPics.backKey==n[r].sKey)return void i.warn("请不要上传相同的图片！",3e3);if("front"===e){a.idcardPics.frontExt=n[r].sExt,a.idcardPics.frontKey=n[r].sKey;var o="http://"+window.configUrl.viewUrl+"/view/house/"+n[r].sKey+"/900x675."+n[r].sExt;t(".front-img").attr("src",o)}else if("back"===e){a.idcardPics.backExt=n[r].sExt,a.idcardPics.backKey=n[r].sKey;var o="http://"+window.configUrl.viewUrl+"/view/house/"+n[r].sKey+"/900x675."+n[r].sExt;t(".back-img").attr("src",o)}}a.emptyOrFull()},error:function(){i.warn("网路错误，请稍后再试",3e3)},complete:function(){a.loading.hide()}})},emptyOrFull:function(){""!==this.idcardPics.frontKey?(t(".front-img-area").find(".btn-empty-wrapper").hide(),t(".idcard-main").on("mouseover mouseout",".front-img-area",function(){"mouseover"==event.type?t(this).find(".btn-full-wrapper").show():"mouseout"==event.type&&t(this).find(".btn-full-wrapper").hide()})):(t(".front-img-area").find(".btn-empty-wrapper").show(),t(".front-img-area").find(".btn-full-wrapper").hide()),""!==this.idcardPics.backKey?(t(".back-img-area").find(".btn-empty-wrapper").hide(),t(".idcard-main").on("mouseover mouseout",".back-img-area",function(){"mouseover"==event.type?t(this).find(".btn-full-wrapper").show():"mouseout"==event.type&&t(this).find(".btn-full-wrapper").hide()})):(t(".back-img-area").find(".btn-empty-wrapper").show(),t(".back-img-area").find(".btn-full-wrapper").hide())},initAjax:function(){var n=this;t.ajax({url:window.configUrl.userInfo,type:"get",dataType:"json",success:function(e){if(e.success){if(e.data.identityCardFrontKey&&e.data.identityCardBackKey){n.idcardPics.frontExt=e.data.identityCardFrontExt,n.idcardPics.frontKey=e.data.identityCardFrontKey;var a="http://"+window.configUrl.viewUrl+"/view/house/"+e.data.identityCardFrontKey+"/900x675."+e.data.identityCardFrontExt;t(".front-img").attr("src",a),n.idcardPics.backExt=e.data.identityCardBackExt,n.idcardPics.backKey=e.data.identityCardBackKey;var a="http://"+window.configUrl.viewUrl+"/view/house/"+e.data.identityCardBackKey+"/900x675."+e.data.identityCardBackExt;t(".back-img").attr("src",a)}n.emptyOrFull()}else i.warn(e.code,3e3)},error:function(){i.warn("网路错误，请稍后再试",3e3)}})},submitAjax:function(){var n=this,e=n.idcardPics;return""===e.backKey||""===e.frontKey?void i.warn("请上传身份证照片正反面！",3e3):void t.ajax({url:window.configUrl.submitUrl,contentType:"application/json; charset=UTF-8",type:"post",data:JSON.stringify(e),dataType:"json",success:function(t){t.success?(i.success("保存成功"),setTimeout(function(){location.href="/pc/user/setting"},1e3)):i.warn("请上传身份证照片正反面！",3e3)},error:function(){i.warn("网路错误，请稍后再试",3e3)}})}};e.init()})});