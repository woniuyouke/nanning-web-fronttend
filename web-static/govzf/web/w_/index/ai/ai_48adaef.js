define("web:widget/index/ai/ai.js",function(e){"use strict";function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}e.async(["common:components/jquery/jquery.js","common:components/ui/util/storage.js","common:components/pcUI/template/template.js","web:components/dropSelect/dropSelect.js"],function(e,n,a){function l(){function n(e,t){var n=new RegExp("(^|-)"+t+"([^-]*)(-|$)"),a=e.match(n);return null!=a?a[2]:null}function a(t,n){return e.map(t,function(e,t){return{key:parseInt(t,10)+n,value:e.name||e,params:e.value||e.id||parseInt(t,10)+n}})}function l(e,t,n){var a=o&&o[t];return a?e.filter(function(e){return n?a.indexOf(e.params)>=0:e.params==a}).map(function(e){return e.key}):[]}if(c){var u=decodeURIComponent(localStorage.getItem("searchquery"));o=e.extend(o,{pe:n(u,"pe"),ar:n(u,"ar"),rm:n(u,"rm")})}var p={defaultValue:[],mainWidth:120,rangeFlag:!1,type:"single",showSelectedVal:!0},d={};e.each(intelligenceFilter.roomNum.list,function(e,t){e&&(d[e]=t)});{var g={rentSelectData:a(intelligenceFilter.priceRange.list,1),layoutSelectData:a(d,0),regionSelectData:a(intelligenceFilter.regions.list,1)},m=l(g.rentSelectData,"pe"),f=e.extend({},p,{title:"选择租房价格区间",data:g.rentSelectData,defaultValue:m,defaultRange:m&&m.length>0?[]:o&&o.pe&&o.pe.split("_")||[],rangeFlag:!0,toggleMode:"click",selectedClassName:"selected",needDefaultOption:!1,rangeConfig:{unit:"元",fromPlaceholder:"最低租金",toPlaceholder:"最高租金"},selectHandler:function(e){var n=e&&e[0]||"",a=e&&e.length&&"1"!==e[0]?g.rentSelectData[n-1].params:"";r(t({},intelligenceFilter.priceRange.alias,a))},confirmHandler:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=e.from,a=void 0===n?"":n,l=e.to,i=void 0===l?"":l,s=a||i?a+"_"+i:"";r(t({},intelligenceFilter.priceRange.alias,s))}}),h=(e("#ai_rentprice").dropSelect(f),e.extend({},p,{title:"选择心仪户型",defaultValue:l(g.layoutSelectData,"rm",!0),toggleMode:"click",data:g.layoutSelectData,type:"multiple",selectedClassName:"selected",selectHandler:function(e){var n=e&&e.length?""+e.join("_"):"";r(t({},intelligenceFilter.roomNum.alias,n))}})),y=(e("#ai_layout").dropSelect(h),e.extend({},p,{title:"选择租房区域",defaultValue:l(g.regionSelectData,"ar"),toggleMode:"click",needDefaultOption:!1,data:g.regionSelectData,type:"single",selectedClassName:"selected",selectHandler:function(e){var n=e&&e.length&&"1"!==e[0]?""+g.regionSelectData[e[0]-1].params:"";r(t({},intelligenceFilter.regions.alias,n))}}));e("#ai_region").dropSelect(y)}e("#ai_submit").click(function(){i();window.location.href=myHeader.config.intelligenceUrl}),i()&&s()}function r(t){o=e.extend(o,t),e("#ai-alert-tip").hide()}function i(){var t=[];return e.each(o,function(e,n){n&&t.push(e+n)}),c&&localStorage.setItem("searchquery",encodeURIComponent(t.join("-"))),t.join("-")}function s(){var t=i(),n='<a class="house-gallery-card-item <%= index % 3 === 0 ? \'no-margin\' : \'\' %> <%= index <= 3 ? \'no-margin-top\' : \'\'%>" href="<%= list.url %>">\r\n    <div class="house-gallery-card-item-img">\r\n        <img src="<%= list.picUrls[0] %>">\r\n        <% if(list.category && list.category == 2){ %>\r\n        <span class="layoutAll">统一装修户型 </span>\r\n        <% } %>\r\n        <% if(list.vrShow && list.vrShow == 1){ %>\r\n        <span class="vr-icon iconfont"></span>\r\n        <% } %>\r\n    </div>\r\n    <p class="house-gallery-card-item-tit">\r\n      <span class="name"><%= list.title %></span>\r\n      <% if(list.location){ %>\r\n      <span class="location">\r\n        <%= list.location %>\r\n      </span>\r\n      <% } %>\r\n    </p>\r\n    <p class="house-gallery-card-item-info">\r\n      <span class="layout">\r\n        <% if(list.rentType == 1){ %>\r\n        <span>整租</span>\r\n        <% }else if(list.rentType == 2){ %>\r\n        <span>合租</span>\r\n        <% } %>\r\n        <% if(list.layout){ %>\r\n        <span><%= list.layout %></span>\r\n        <% } %>\r\n        <% if(list.area){ %>\r\n        <span><%= list.area %></span>\r\n        <% } %>\r\n      </span>\r\n    </p>\r\n    <p class="price"><%= list.price %>元/月</p>\r\n\r\n</a>\r\n';e.ajax({url:aiUrl+(t&&t.length>0?"/":"")+t,type:"get",data:{page:1,perPage:3},dataType:"json",success:function(t){if(t&&t.data&&t.data.list&&t.data.total){e("#no-ai-tip").hide(),e("#ai_result").show();for(var l=t.data.list,r=[],i=0;i<l.length&&3>i;i++){var s=l[i];r.push(a.parse(n,{list:s,index:i+1}))}e("#ai_result_list").html(r.join(""))}else e("#ai_result").hide(),e("#no-ai-tip").show()},error:function(){}})}var o={},c=n.checkLS();l()})});