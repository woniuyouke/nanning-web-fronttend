define("common:components/ui/formValid/formValid.js",function(e){var r=e("common:components/ui/zepto/zepto.js"),t=e("common:components/ui/class/class.js"),s=t.$factory("formValid",{initialize:function(e){this.options=r.extend({dom:null,rules:{},showSuccessStatus:!1,showErrorStatus:!0,errorStop:!1,skipHidden:!1},e||{}),this.init()},init:function(){this.dom=r(this.options.dom),this.rules={},this.setRules(),this.reset()},setRules:function(e){{var t=this,i=s.DEFAULT_RULES,n=s.ATTRIBUTE_PREFIX;s.ATTIBUTE_LENGTH,s.ATTRIBUTE_RULE}e&&(t.options.rules=e),t.removeRule(),t.getElement().each(function(){var e=this.name;if(e){var s=r(this);r.each(i,function(r,i){var o=n+r;if(null!=s.attr(o)){var u={errorText:s.attr(o+"-error")||i.errorText,successText:s.attr(o+"-success")||i.successText,standard:s.attr(o)};u[r]=s.attr(o),t.addRule(e,u)}})}}),t.addRule(t.options.rules)},check:function(e){var t,i=this,n=!0,o=i.rules,u=i.options.errorStop,a=i.options.skipHidden;i.reset(e,!1),e?(t={},t[e]=o[e]||{}):t=o;for(var l in t){var c=i.getElement(l);if(!(!c.length||c.is(":disabled")||c.is(":hidden")&&a)){var d=t[l],f=s.isCheckBtn(c)?c.filter(":checked").val():c.val(),T=!0;null==f&&(f=""),r.isArray(d)||(d=[d]);for(var h,m=0;m<d.length;m++)if(h=d[m],"function"!=typeof h.rule||h.rule.call(this,f,l,h.standard)?h.rule.constructor!=RegExp||h.rule.test(f)||(n=!1,T=!1):(n=!1,T=!1),!T){if(i.error(l,h.errorText,h.showErrorStatus||i.options.showErrorStatus),u)return n;break}T&&i.success(l,h.successText,h.showSuccessStatus||i.options.showSuccessStatus)}}return n},error:function(e,r,t){null!=r&&t!==!1&&(r=r||"",this.setText(e,r||"","ui2-formvalid-field-error")),this.trigger("error",[e,r])},success:function(e,r,t){null!=r&&t!==!1&&(r=r||"",this.setText(e,r,"ui2-formvalid-field-success")),this.trigger("success",[e,r])},setText:function(e,r,t){var s=this.getElement(e).parent();s.find('.ui2-formvalid-field[data-formvalid-target="'+e+'"]').remove(),null!=r&&s.append('<span class="ui2-formvalid-field '+t+'" data-formvalid-target="'+e+'">'+(r||"&nbsp;")+"</span>")},reset:function(e,t){var i=this;if(e){var n;(null==t||t)&&(n=i.getElement(e).attr(s.ATTRIBUTE_DEFAULT)),i.setText(e,n,"ui2-formvalid-field-default")}else i.getElement().each(function(){var e=this.name;e&&((null==t||t)&&(n=r(this).attr(s.ATTRIBUTE_DEFAULT)),i.setText(e,n,"ui2-formvalid-field-default"))})},addRule:function(e,t){var i=this;if("object"==typeof e)r.each(e,function(e,r){i.addRule(e,r)});else{var n=i.rules[e]||[];r.isArray(n)||(n=[n]);var o=[];Array.isArray(t)||(t=[t]),r.each(t,function(e,t){var i=t.rule;i?o.push(t):r.each(s.DEFAULT_RULES,function(e,s){e in t&&o.push(r.extend({},t,{rule:s.rule,errorText:t.errorText||s.errorText,standard:t[e]}))})}),n.push.apply(n,o),i.rules[e]=n}},removeRule:function(e){e?delete this.rules[e]:this.rules={}},getElement:function(e){return this.dom.find(e?'[name="'+e+'"]':"[name]")}});return r.extend(s,{ATTRIBUTE_PREFIX:"data-formvalid-",DEFAULT_RULES:{required:{rule:/\S+/,errorText:"该字段必填"},email:{rule:/^(?:\w[\w_-]*@[\w_-]+(?:\.[\w_-]+)+|\S+)$/i,errorText:"邮箱地址格式错误"},mobile:{rule:/^\d{11}$/,errorText:"手机号码格式错误"},idcard:{rule:/^(?:\d{14}|\d{17})[\dx]$/i,errorText:"身份证格式错误"},number:{rule:/^(?:\d+(?:\.\d+)?)$/,errorText:"该字段必须为数字"},range:{rule:function(e,t,s){return""==r.trim(e)?!0:(s=s.replace(/\s+/g,"").split(","),s[0]&&e<s[0]?!1:s[1]&&e>s[1]?!1:!0)},errorText:"字段输入范围错误"},length:{rule:function(e,t,s){if(""==r.trim(e))return!0;s=s.replace(/\s+/g,"").split(",");var i=String(e).length;return s[0]&&i<s[0]?!1:null==s[1]?i==s[0]:s[1]&&i>s[1]?!1:!0},errorText:"字段输入长度错误"}}}),s.ATTRIBUTE_DEFAULT=s.ATTRIBUTE_PREFIX+"default",s.isCheckBtn=function(e){return e.length&&/checkbox|radio/i.test(e.attr("type"))},s});