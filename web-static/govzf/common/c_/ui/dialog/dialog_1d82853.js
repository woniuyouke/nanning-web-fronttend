define("common:components/ui/dialog/dialog.js",function(t,o,e){var i=t("common:components/ui/zepto/zepto.js"),n=t("common:components/ui/class/class.js"),s=t("common:components/ui/mask/mask.js"),a=t("common:components/ui/iscroll/iscroll.js"),r=document;e.exports=n.$factory("dialog",{initialize:function(t){this.options=i.extend({title:"",dom:null,width:"80%",height:!1,content:"",url:"",mask:!0,autoOpen:!1,buttons:{},handle:null,className:"",customWraper:!1},t||{}),this.init()},init:function(){var t=this;t.firstOpenStatus=!1,t.dom=null,t.create(),t.options.autoOpen&&t.open()},create:function(){var t=this;t.createMask(),t.createWraper(),t.initEvent()},initEvent:function(){var t=this,o=t.options;t.o2s(window,"resize",function(){t.resetPosition()}),o.handle&&t.o2s(o.handle,"tap",function(){t.open()}),t.wraper.find(".ui2-dialog-close").tap(function(){t.close()})},createMask:function(){this.options.mask&&(this.mask=new s({autoOpen:!1}))},createWraper:function(){var t,o=this,e=o.options;e.customWraper&&e.dom?(o.wraper=i(e.dom).addClass("ui2-dialog-wraper-custom ui2-dialog-wraper"),o.content=o.wraper.find(".ui2-dialog-content")):(t=o.wraper=i('<div class="ui2-dialog-wraper ui2-dialog-wraper-uncustom">'),t.html(['<strong class="ui2-dialog-header">','<a href="javascript:void(0);" class="ui2-dialog-close"></a>','<span class="ui2-dialog-title"></span>',"</strong>"].join("")),o.setTitle(e.title),o.content=i('<div class="ui2-dialog-content"><div class="ui2-dialog-scroll"></div></div>').appendTo(t),o.initContent()),o.wraper.appendTo(r.body).addClass(e.className),o.createButtons()},initContent:function(){var t=this,o=t.options;o.content?t.setContent(o.content):o.dom?t.setDom(o.dom):o.url&&t.load(o.url)},setContent:function(t){var o=this;o.releaseDom(),o.content.find(".ui2-dialog-scroll").html(t),o.resetPosition()},setDom:function(t){var o=this;o.releaseDom(),o.dom=i(t).show(),o.content.find(".ui2-dialog-scroll").empty().append(o.dom),o.resetPosition()},load:function(t){var o=this;o.content.find(".ui2-dialog-scroll").load(t,function(){o.trigger("contentLoaded"),o.resetPosition()})},releaseDom:function(t){var o=this;(t||(t=o.dom))&&(i(r.body).append(t),o.options.customWraper&&t.removeClass("ui2-dialog-wraper-custom ui2-dialog-wraper").removeClass(o.options.className),o.dom&&(o.dom=null))},createButtons:function(){var t=this;i.isEmptyObject(t.options.buttons)||(t.buttons=i('<div class="ui2-dialog-buttons">').appendTo(t.wraper),t.setButtons(t.options.buttons))},setButtons:function(t){var o=this;o.buttons.empty(),i.each(t,function(t,e){i.isFunction(e)&&(e={events:{tap:e},className:""});var n=i('<a href="javascript:void(0);" class="ui2-dialog-button" data-dialog-button-name="'+t+'" />').text(t).addClass(e.className).appendTo(o.buttons);i.each(e.events,function(t,e){n.on(t,function(){e.call(o,n)})})})},getButton:function(t){var o=this.buttons.find(".ui2-dialog-button");return"number"==typeof t?o.eq(t):o.filter('[data-dialog-button-name="'+t+'"]')},setTitle:function(t){var o=this.wraper.find(".ui2-dialog-header");o.removeClass("ui2-dialog-header-nob"),t===!1?o.hide():""==t&&o.addClass("ui2-dialog-header-nob").css("display","block"),o.find(".ui2-dialog-title").html(t)},resetPosition:function(){var t=this,o=t.options;t.mask&&t.mask.resetPosition();var e,n,s=i(window);o.width&&(e=/%/.test(o.width)?s.width()*parseFloat(o.width)/100:o.width),o.height&&(n=/%/.test(o.height)?s.height()*parseFloat(o.height)/100:o.height),t.content.css({width:e,height:n}),t.wraper.css("left","0px"),t.wraper.css({left:parseInt((s.width()-t.wraper.width())/2),top:parseInt((s.height()-t.wraper.height())/2)}),o.scroll&&new a(t.content[0])},open:function(){{var t=this;t.options}t.mask&&t.mask.open(),t.wraper.show(),t.resetPosition(),t.firstOpenStatus||(t.firstOpenStatus=!0,t.trigger("firstOpen")),t.trigger("open")},close:function(){{var t=this;t.options}t.mask&&t.mask.close(),t.wraper.hide(),t.trigger("close")},destroy:function(){var t=this,o=t.options;t.mask&&t.mask.destroy(),t.mask=null,o.customWraper?t.releaseDom(t.wraper):(t.wraper.remove(),t.releaseDom()),t.wraper=null,t.ofs(window,"resize"),o.handle&&t.ofs(o.handle,"tap"),t.ofs(r,"keyup")}})});